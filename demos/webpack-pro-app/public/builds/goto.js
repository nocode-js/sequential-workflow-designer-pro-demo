(()=>{"use strict";var t={769:(t,e,n)=>{n.d(e,{Z:()=>a});var s=n(601),i=n.n(s),o=n(609),r=n.n(o)()(i());r.push([t.id,"/* light > .sqd-path-bar */\n\n.sqd-theme-light .sqd-path-bar {\n\tbackground: #FFF;\n\tbox-shadow: 0 0 8px rgba(0, 0, 0, .15), 0 2px 4px rgba(0, 0, 0, .15);\n}\n.sqd-theme-light .sqd-path-bar-item:hover {\n\tborder-color: #939393;\n}\n.sqd-theme-light .sqd-path-bar-separator {\n\tcolor: #D0D0D0;\n}\n.sqd-theme-light .sqd-path-bar-reset-button {\n\tborder: 1px solid transparent;\n}\n.sqd-theme-light .sqd-path-bar-reset-button:hover {\n\tborder-color: #939393;\n}\n\n/* light > .sqd-icon */\n\n.sqd-theme-light .sqd-step-icon-circle {\n\tfill: #FFF;\n\tstroke: #C3C3C3;\n\tfilter: drop-shadow(0 1.5px 1.5px rgba(0, 0, 0, .15));\n}\n.sqd-theme-light .sqd-step-icon-circle.sqd-selected {\n\tstroke: #ED4800;\n}\n\n/* light > .sqd-large-task */\n\n.sqd-theme-light .sqd-large-task-rect {\n\tfill: #FFF;\n\tstroke: #C3C3C3;\n\tfilter: drop-shadow(0 1.5px 1.5px rgba(0, 0, 0, .15));\n}\n.sqd-theme-light .sqd-large-task-rect.sqd-selected {\n\tstroke: #ED4800;\n}\n.sqd-theme-light .sqd-large-task-description-text {\n\tfill: #8b8c91;\n}\n.sqd-theme-light .sqd-large-task-circle {\n\tstroke: #9da3ae;\n}\n\n/* light > .sqd-step-folder */\n\n.sqd-theme-light .sqd-step-folder-rect {\n\tfill: #FAD876;\n\tstroke: #CAAE5C;\n\tfilter: drop-shadow(0 1.5px 1.5px rgba(0, 0, 0, .15));\n}\n.sqd-theme-light .sqd-step-folder-rect.sqd-selected {\n\tstroke: #ED4800;\n}\n.sqd-theme-light .sqd-step-folder-tab-rect {\n\tfill: #7C631B;\n}\n.sqd-theme-light .sqd-step-folder-empty-icon {\n\tfill: #7C631B;\n}\n.sqd-theme-light .sqd-step-folder-button-text {\n\tfill: #7C631B;\n}\n.sqd-theme-light .sqd-step-folder-button-rect {\n\tstroke: #7C631B;\n}\n.sqd-theme-light .sqd-step-folder-button-rect:hover {\n\tstroke: #CAAE5C;\n}\n.sqd-theme-light .sqd-step-folder-button-icon-path {\n\tfill: #7C631B;\n}\n\n/* light > .sqd-root-minimal */\n\n.sqd-theme-light .sqd-root-minimal-empty {\n\tstroke: #2C18DF;\n}\n\n/* .sqd-counter-badge */\n\n.sqd-theme-light .sqd-counter-badge-text {\n\tfill: #FFF;\n}\n.sqd-theme-light .sqd-counter-badge-rect {\n\tfill: #9B9B9B;\n}\n\n/* .sqd-clickable-placeholder */\n\n.sqd-theme-light .sqd-clickable-placeholder-rect {\n\tfill: #D9D9D9;\n}\n.sqd-theme-light .sqd-clickable-placeholder:hover .sqd-clickable-placeholder-rect {\n\tfill: #BFBFBF;\n}\n",""]);const a=r},279:(t,e,n)=>{n.d(e,{Z:()=>a});var s=n(601),i=n.n(s),o=n(609),r=n.n(o)()(i());r.push([t.id,"/* .sqd-path-bar */\n\n.sqd-path-bar {\n\tposition: absolute;\n\tbottom: 68px;\n\tpadding: 4px;\n\tleft: 10px;\n\tz-index: 20;\n\tborder-radius: 10px;\n}\n.sqd-path-bar-reset-button {\n\tdisplay: inline-block;\n\tvertical-align: middle;\n\twidth: 26px;\n\theight: 26px;\n\tborder-radius: 5px;\n\tcursor: pointer;\n}\n.sqd-path-bar-reset-button-icon {\n\twidth: 20px;\n\theight: 20px;\n\tmargin: 3px 0 0 3px;\n}\n.sqd-path-bar-items {\n\tmargin-left: 2px;\n\tdisplay: inline-block;\n\tvertical-align: middle;\n}\n.sqd-path-bar-item {\n\tdisplay: inline-block;\n\tpadding: 6px;\n\tborder-radius: 5px;\n\tcursor: pointer;\n\tborder: 1px solid transparent;\n}\n.sqd-path-bar-separator {\n\tdisplay: inline-block;\n\tpadding: 0 2px;\n}\n\n/* .sqd-step-icon */\n\n.sqd-step-icon-circle {\n\tstroke-width: 1;\n}\n.sqd-step-icon-circle.sqd-selected {\n\tstroke-width: 2;\n}\n\n/* .sqd-large-task */\n\n.sqd-large-task-rect {\n\tstroke-width: 1;\n}\n.sqd-large-task-rect.sqd-selected {\n\tstroke-width: 2;\n}\n.sqd-large-task-name-text {\n\ttext-anchor: left;\n\tdominant-baseline: central;\n\tfont-size: 16px;\n}\n.sqd-large-task-description-text {\n\ttext-anchor: left;\n\tdominant-baseline: central;\n\tfont-size: 12px;\n}\n.sqd-large-task-circle {\n\tfill: none;\n\tstroke-width: 1;\n}\n\n/* .sqd-step-folder */\n\n.sqd-step-folder-rect {\n\tstroke-width: 1;\n}\n.sqd-step-folder-rect.sqd-selected {\n\tstroke-width: 2;\n}\n.sqd-step-folder-name {\n\ttext-anchor: left;\n\tdominant-baseline: central;\n}\n.sqd-step-folder-button-text {\n\tfont-size: 11px;\n\ttext-anchor: left;\n\tdominant-baseline: central;\n}\n.sqd-step-folder-button-rect {\n\tfill: transparent;\n\tcursor: pointer;\n\tstroke-width: 1;\n}\n\n/* .sqd-root-minimal */\n\n.sqd-root-minimal-empty {\n\tfill: transparent;\n\tstroke-width: 2;\n\tstroke-dasharray: 3;\n}\n\n/* .sqd-counter-badge */\n\n.sqd-counter-badge.sqd-clickable {\n\tpointer-events: bounding-box;\n\tcursor: pointer;\n}\n.sqd-counter-badge.sqd-clickable:hover {\n\topacity: 0.7;\n}\n.sqd-counter-badge-text {\n\tfont-size: 11px;\n\ttext-anchor: middle;\n\tdominant-baseline: central;\n}\n\n/* .sqd-clickable-placeholder */\n\n.sqd-clickable-placeholder {\n\tpointer-events: bounding-box;\n\tcursor: pointer;\n}\n",""]);const a=r},929:(t,e,n)=>{n.d(e,{Z:()=>a});var s=n(601),i=n.n(s),o=n(609),r=n.n(o)()(i());r.push([t.id,"\n/********* light *********/\n\n.sqd-theme-light.sqd-designer {\n\tbackground: #F9F9F9;\n}\n\n/* light > .sqd-toolbox */\n\n.sqd-theme-light .sqd-toolbox {\n\tbackground: #FFF;\n\tbox-shadow: 0 0 8px rgba(0, 0, 0, .15), 0 2px 4px rgba(0, 0, 0, .15);\n}\n.sqd-theme-light .sqd-toolbox-filter {\n\tborder: 1px solid #C3C3C3;\n}\n.sqd-theme-light .sqd-toolbox-filter:focus {\n\tborder-color: #939393;\n}\n.sqd-theme-light .sqd-toolbox-group-title {\n\tbackground: #E5E5E5;\n}\n.sqd-theme-light .sqd-toolbox-item {\n\tborder: 1px solid #C3C3C3;\n\tbox-shadow: 0 2px 2px rgba(0, 0, 0, .15);\n}\n.sqd-theme-light .sqd-toolbox-item:hover {\n\tborder: 1px solid #939393;\n}\n.sqd-theme-light .sqd-toolbox-item-icon.sqd-no-icon {\n\tbackground: #C6C6C6;\n}\n\n/* light > .sqd-control-bar */\n\n.sqd-theme-light .sqd-control-bar {\n\tbackground: #FFF;\n\tbox-shadow: 0 0 8px rgba(0, 0, 0, .15), 0 2px 4px rgba(0, 0, 0, .15);\n}\n.sqd-theme-light .sqd-control-bar-button {\n\tborder: 1px solid #C3C3C3;\n}\n.sqd-theme-light .sqd-control-bar-button:hover {\n\tborder-color: #939393;\n}\n.sqd-theme-light .sqd-control-bar-button.sqd-delete .sqd-icon-path {\n\tfill: #E01A24;\n}\n\n/* light > .sqd-workspace */\n\n.sqd-theme-light .sqd-grid-path {\n\tstroke: #E3E3E3;\n}\n.sqd-theme-light .sqd-join {\n\tstroke: #000;\n}\n\n/* light > .sqd-smart-editor */\n\n.sqd-theme-light .sqd-smart-editor {\n\tbackground: #FFF;\n\tbox-shadow: 0 0 8px rgba(0, 0, 0, .15);\n}\n.sqd-theme-light .sqd-smart-editor-toggle {\n\tbackground: #FFF;\n\tbox-shadow: 0 0 8px rgba(0, 0, 0, .15);\n}\n\n/* light > .sqd-step-task */\n\n.sqd-theme-light .sqd-step-task-rect {\n\tfill: #FFF;\n\tstroke: #C3C3C3;\n\tfilter: drop-shadow(0 1.5px 1.5px rgba(0, 0, 0, .15));\n}\n.sqd-theme-light .sqd-step-task-rect.sqd-selected {\n\tstroke: #ED4800;\n}\n.sqd-theme-light .sqd-step-task-text {\n\tfill: #000;\n}\n.sqd-theme-light .sqd-step-task-empty-icon {\n\tfill: #C6C6C6;\n}\n\n/* light > .sqd-input + .sqd-output */\n\n.sqd-theme-light .sqd-input {\n\tfill: #FFF;\n\tstroke: #000;\n}\n\n.sqd-theme-light .sqd-output {\n\tfill: #000;\n}\n\n/* light > .sqd-region */\n\n.sqd-theme-light .sqd-region {\n\tstroke: #CECECE;\n}\n.sqd-theme-light .sqd-region.sqd-selected {\n\tstroke: #ED4800;\n}\n.sqd-theme-light .sqd-label-primary .sqd-label-rect {\n\tfill: #2411DB;\n}\n.sqd-theme-light .sqd-label-secondary .sqd-label-rect {\n\tfill: #000;\n}\n.sqd-theme-light .sqd-label-text {\n\tfill: #FFF;\n}\n\n/* light > .sqd-root-start-stop */\n\n.sqd-theme-light .sqd-root-start-stop-circle {\n\tfill: #2C18DF;\n}\n.sqd-theme-light .sqd-root-start-stop-icon {\n\tfill: #FFF;\n}\n\n/* light > .sqd-placeholder */\n\n.sqd-theme-light .sqd-placeholder .sqd-placeholder-rect {\n\tfill: #D8D8D8;\n\tstroke: #6A6A6A;\n}\n.sqd-theme-light .sqd-placeholder-icon-path {\n\tfill: #2B2B2B;\n}\n.sqd-theme-light .sqd-placeholder.sqd-hover .sqd-placeholder-rect {\n\tfill: #ED4800;\n}\n.sqd-theme-light .sqd-placeholder.sqd-hover .sqd-placeholder-icon-path {\n\tfill: #FFF;\n}\n\n/* light > .sqd-validation-error */\n\n.sqd-theme-light .sqd-validation-error {\n\tfill: #FFA200;\n}\n.sqd-theme-light .sqd-validation-error-icon-path {\n\tfill: #000;\n}\n",""]);const a=r},446:(t,e,n)=>{n.d(e,{Z:()=>a});var s=n(601),i=n.n(s),o=n(609),r=n.n(o)()(i());r.push([t.id,"\n.sqd-designer {\n\tposition: relative;\n\tdisplay: flex;\n\twidth: 100%;\n\theight: 100%;\n}\n.sqd-designer, .sqd-drag {\n\tfont-size: 13px;\n\tline-height: 1em;\n}\n.sqd-hidden {\n\tdisplay: none !important;\n}\n.sqd-disabled {\n\topacity: 0.25;\n}\n\n/* .sqd-toolbox */\n\n.sqd-toolbox, .sqd-toolbox-filter {\n\tfont-size: 11px;\n\tline-height: 1.2em;\n}\n.sqd-toolbox {\n\tposition: absolute;\n\ttop: 10px;\n\tleft: 10px;\n\tz-index: 20;\n\tbox-sizing: border-box;\n\tborder-radius: 10px;\n\twidth: 130px;\n\tuser-select: none;\n}\n.sqd-toolbox-header {\n\tposition: relative;\n\tpadding: 15px 10px;\n\tcursor: pointer;\n}\n.sqd-toolbox-header-title {\n\tdisplay: block;\n\tfont-size: 1.2em;\n\tline-height: 1em;\n\tfont-weight: bold;\n}\n.sqd-toolbox-toggle-icon {\n\tposition: absolute;\n\ttop: 50%;\n\tright: 10px;\n\twidth: 16px;\n\theight: 16px;\n\tmargin: -8px 0 0;\n}\n.sqd-toolbox-header:hover .sqd-toolbox-toggle-icon {\n\topacity: .6;\n}\n.sqd-scrollbox {\n\tposition: relative;\n\toverflow: hidden;\n}\n.sqd-scrollbox-body {\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n}\n.sqd-toolbox-filter {\n\tdisplay: block;\n\tbox-sizing: border-box;\n\tpadding: 6px 8px;\n\toutline: none;\n\twidth: 110px;\n\tmargin: 0 10px 10px;\n\tbox-sizing: border-box;\n\tborder-radius: 10px;\n}\n.sqd-toolbox-group-title {\n\ttext-align: center;\n\tpadding: 5px 0;\n\tmargin: 0 10px 10px;\n\tborder-radius: 10px;\n}\n.sqd-toolbox-item {\n\tposition: relative;\n\tborder-radius: 5px;\n\tbox-sizing: border-box;\n\tmargin: 0 10px 10px;\n\twidth: 110px;\n\tcursor: move;\n}\n.sqd-toolbox-item-icon {\n\tposition: absolute;\n\ttop: 50%;\n\tleft: 5px;\n\tmargin-top: -10px;\n\twidth: 20px;\n\theight: 20px;\n}\n.sqd-toolbox-item-icon.sqd-no-icon {\n\tborder-radius: 4px;\n}\n.sqd-toolbox-item-icon-image {\n\twidth: 100%;\n\theight: 100%;\n}\n.sqd-toolbox-item-text {\n\tposition: relative;\n\tdisplay: block;\n\tpadding: 10px 10px 10px 30px;\n\twhite-space: nowrap;\n\ttext-overflow: ellipsis;\n\toverflow: hidden;\n}\n\n.sqd-drag {\n\tposition: absolute;\n\tz-index: 9999999;\n\tpointer-events: none;\n}\n\n/* .sqd-control-bar */\n\n.sqd-control-bar {\n\tposition: absolute;\n\tbottom: 10px;\n\tleft: 10px;\n\tz-index: 20;\n\tpadding: 8px 0 8px 8px;\n\tborder-radius: 10px;\n\twhite-space: nowrap;\n}\n.sqd-control-bar-button {\n\tdisplay: inline-block;\n\twidth: 30px;\n\theight: 30px;\n\tborder-radius: 5px;\n\tmargin-right: 8px;\n\tcursor: pointer;\n}\n.sqd-control-bar-button-icon {\n\twidth: 24px;\n\theight: 24px;\n\tmargin: 3px 0 0 3px;\n}\n.sqd-control-bar-button.sqd-disabled .sqd-control-bar-button-icon {\n\topacity: .2;\n}\n\n/* .sqd-workspace */\n\n.sqd-workspace {\n\tflex: 1;\n\tposition: relative;\n\tdisplay: block;\n\tuser-select: none;\n}\n.sqd-workspace-canvas {\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\tcursor: move;\n}\n.sqd-grid-path {\n\tstroke-width: 1;\n}\n.sqd-join {\n\tstroke-width: 2;\n}\n\n/* .sqd-smart-editor */\n\n.sqd-smart-editor-toggle {\n\tposition: absolute;\n\ttop: 0;\n\tz-index: 29;\n\twidth: 36px;\n\theight: 64px;\n\tborder-bottom-left-radius: 10px;\n\tcursor: pointer;\n}\n.sqd-smart-editor-toggle-icon {\n\tposition: absolute;\n\ttop: 50%;\n\tleft: 50%;\n\twidth: 24px;\n\theight: 24px;\n\tmargin: -12px 0 0 -12px;\n}\n.sqd-smart-editor-toggle:hover .sqd-smart-editor-toggle-icon {\n\topacity: .6;\n}\n.sqd-smart-editor {\n\tz-index: 30;\n}\n.sqd-layout-desktop .sqd-smart-editor {\n\tposition: relative;\n\twidth: 300px;\n}\n.sqd-layout-desktop .sqd-smart-editor-toggle {\n\tright: 300px;\n}\n.sqd-layout-desktop .sqd-smart-editor-toggle.sqd-collapsed {\n\tright: 0;\n}\n.sqd-layout-mobile .sqd-smart-editor {\n\tposition: absolute;\n\ttop: 0;\n\tright: 0;\n\tbottom: 0;\n\tleft: 41px;\n}\n.sqd-layout-mobile .sqd-smart-editor-toggle {\n\tleft: 5px;\n}\n.sqd-layout-mobile .sqd-smart-editor-toggle.sqd-collapsed {\n\tleft: auto;\n\tright: 0;\n}\n\n/* .sqd-step-task */\n\n.sqd-step-task-rect {\n\tstroke-width: 1;\n}\n.sqd-step-task-rect.sqd-selected {\n\tstroke-width: 2;\n}\n.sqd-step-task-text {\n\ttext-anchor: left;\n\tdominant-baseline: central;\n}\n\n/* .sqd-input + .sqd-output */\n\n.sqd-input {\n\tstroke-width: 2;\n}\n\n/* .sqd-region */\n\n.sqd-region {\n\tstroke-width: 2;\n\tstroke-dasharray: 3;\n}\n.sqd-region.sqd-selected {\n\tstroke-width: 2;\n\tstroke-dasharray: 0;\n}\n.sqd-label-text {\n\ttext-anchor: middle;\n\tdominant-baseline: central;\n}\n\n/* .sqd-placeholder */\n\n.sqd-placeholder .sqd-placeholder-rect {\n\tstroke-width: 1;\n\tstroke-dasharray: 3;\n\ttransition: fill 100ms;\n}\n",""]);const a=r},609:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",s=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),s&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),s&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,s,i,o){"string"==typeof t&&(t=[[null,t,void 0]]);var r={};if(s)for(var a=0;a<this.length;a++){var d=this[a][0];null!=d&&(r[d]=!0)}for(var l=0;l<t.length;l++){var c=[].concat(t[l]);s&&r[c[0]]||(void 0!==o&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=o),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),i&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=i):c[4]="".concat(i)),e.push(c))}},e}},601:t=>{t.exports=function(t){return t[1]}},62:t=>{var e=[];function n(t){for(var n=-1,s=0;s<e.length;s++)if(e[s].identifier===t){n=s;break}return n}function s(t,s){for(var o={},r=[],a=0;a<t.length;a++){var d=t[a],l=s.base?d[0]+s.base:d[0],c=o[l]||0,h="".concat(l," ").concat(c);o[l]=c+1;var p=n(h),u={css:d[1],media:d[2],sourceMap:d[3],supports:d[4],layer:d[5]};if(-1!==p)e[p].references++,e[p].updater(u);else{var g=i(u,s);s.byIndex=a,e.splice(a,0,{identifier:h,updater:g,references:1})}r.push(h)}return r}function i(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,i){var o=s(t=t||[],i=i||{});return function(t){t=t||[];for(var r=0;r<o.length;r++){var a=n(o[r]);e[a].references--}for(var d=s(t,i),l=0;l<o.length;l++){var c=n(o[l]);0===e[c].references&&(e[c].updater(),e.splice(c,1))}o=d}}},793:t=>{var e={};t.exports=function(t,n){var s=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(n)}},173:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},892:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},36:t=>{t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var s="";n.supports&&(s+="@supports (".concat(n.supports,") {")),n.media&&(s+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(s+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),s+=n.css,i&&(s+="}"),n.media&&(s+="}"),n.supports&&(s+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(s,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},464:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},e={};function n(s){var i=e[s];if(void 0!==i)return i.exports;var o=e[s]={id:s,exports:{}};return t[s](o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var s in e)n.o(e,s)&&!n.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nc=void 0,(()=>{class t{constructor(t,e,n,s){this.state=t,this.historyController=e,this.definitionModifier=n,this.viewportApi=s}subscribe(t){this.state.onIsReadonlyChanged.subscribe(t),this.state.onSelectedStepIdChanged.subscribe(t),this.state.onIsDragDisabledChanged.subscribe(t),this.isUndoRedoSupported()&&this.state.onDefinitionChanged.subscribe(t)}resetViewport(){this.viewportApi.resetViewport()}zoomIn(){this.viewportApi.zoom(!0)}zoomOut(){this.viewportApi.zoom(!1)}isDragDisabled(){return this.state.isDragDisabled}toggleIsDragDisabled(){this.state.toggleIsDragDisabled()}isUndoRedoSupported(){return!!this.historyController}tryUndo(){return!(!this.canUndo()||!this.historyController||(this.historyController.undo(),0))}canUndo(){return!!this.historyController&&this.historyController.canUndo()&&!this.state.isReadonly&&!this.state.isDragging}tryRedo(){return!(!this.canRedo()||!this.historyController||(this.historyController.redo(),0))}canRedo(){return!!this.historyController&&this.historyController.canRedo()&&!this.state.isReadonly&&!this.state.isDragging}tryDelete(){return!(!this.canDelete()||!this.state.selectedStepId||(this.definitionModifier.tryDelete(this.state.selectedStepId),0))}canDelete(){return!!this.state.selectedStepId&&!this.state.isReadonly&&!this.state.isDragging&&this.definitionModifier.isDeletable(this.state.selectedStepId)}}class e{constructor(){this.listeners=[]}subscribe(t){this.listeners.push(t)}unsubscribe(t){const e=this.listeners.indexOf(t);if(!(e>=0))throw new Error("Unknown listener");this.listeners.splice(e,1)}forward(t){this.listeners.length>0&&this.listeners.forEach((e=>e(t)))}count(){return this.listeners.length}}class s{constructor(t,e){this.x=t,this.y=e}add(t){return new s(this.x+t.x,this.y+t.y)}subtract(t){return new s(this.x-t.x,this.y-t.y)}multiplyByScalar(t){return new s(this.x*t,this.y*t)}divideByScalar(t){return new s(this.x/t,this.y/t)}round(){return new s(Math.round(this.x),Math.round(this.y))}distance(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))}}var i,o,r,a,d,l;!function(t){t[t.stepNameChanged=1]="stepNameChanged",t[t.stepPropertyChanged=2]="stepPropertyChanged",t[t.stepChildrenChanged=3]="stepChildrenChanged",t[t.stepDeleted=4]="stepDeleted",t[t.stepMoved=5]="stepMoved",t[t.stepInserted=6]="stepInserted",t[t.globalPropertyChanged=7]="globalPropertyChanged",t[t.rootReplaced=8]="rootReplaced"}(i||(i={}));class c{constructor(t,n){this.definition=t,this.isReadonly=n,this.onViewportChanged=new e,this.onSelectedStepIdChanged=new e,this.onFolderPathChanged=new e,this.onIsReadonlyChanged=new e,this.onIsDraggingChanged=new e,this.onIsDragDisabledChanged=new e,this.onDefinitionChanged=new e,this.viewport={position:new s(0,0),scale:1},this.selectedStepId=null,this.folderPath=[],this.isDragging=!1,this.isDragDisabled=!1}setSelectedStepId(t){this.selectedStepId!==t&&(this.selectedStepId=t,this.onSelectedStepIdChanged.forward(t))}pushStepIdToFolderPath(t){this.folderPath.push(t),this.onFolderPathChanged.forward(this.folderPath)}setFolderPath(t){this.folderPath=t,this.onFolderPathChanged.forward(t)}tryGetLastStepIdFromFolderPath(){return this.folderPath.length>0?this.folderPath[this.folderPath.length-1]:null}setDefinition(t){this.definition=t,this.notifyDefinitionChanged(i.rootReplaced,null)}notifyDefinitionChanged(t,e){this.onDefinitionChanged.forward({changeType:t,stepId:e})}setViewport(t){this.viewport=t,this.onViewportChanged.forward(t)}setIsReadonly(t){this.isReadonly!==t&&(this.isReadonly=t,this.onIsReadonlyChanged.forward(t))}setIsDragging(t){this.isDragging!==t&&(this.isDragging=t,this.onIsDraggingChanged.forward(t))}toggleIsDragDisabled(){this.isDragDisabled=!this.isDragDisabled,this.onIsDragDisabledChanged.forward(this.isDragDisabled)}}class h{static svg(t,e){const n=document.createElementNS("http://www.w3.org/2000/svg",t);return e&&h.attrs(n,e),n}static translate(t,e,n){t.setAttribute("transform",`translate(${e}, ${n})`)}static attrs(t,e){Object.keys(e).forEach((n=>{const s=e[n];t.setAttribute(n,"string"==typeof s?s:s.toString())}))}static element(t,e){const n=document.createElement(t);return e&&h.attrs(n,e),n}static toggleClass(t,e,n){e?t.classList.add(n):t.classList.remove(n)}}class p{static appendPath(t,e,n,s){const i=h.svg("g"),o=s/48,r=h.svg("path",{d:n,class:e,transform:`scale(${o})`});return i.appendChild(r),t.appendChild(i),i}static createSvg(t,e){const n=h.svg("svg",{class:t,viewBox:"0 0 48 48"}),s=h.svg("path",{d:e,class:"sqd-icon-path"});return n.appendChild(s),n}}p.folderIn="M42.05 42.25H11.996v-7.12h17.388L6 11.746 11.546 6.2 34.93 29.584V12.196h7.12V42.25z",p.folderOut="M6 6.2h30.054v7.12H18.666L42.05 36.704l-5.546 5.546L13.12 18.866v17.388H6V6.2z",p.center="M9 42q-1.2 0-2.1-.9Q6 40.2 6 39v-8.6h3V39h8.6v3Zm21.4 0v-3H39v-8.6h3V39q0 1.2-.9 2.1-.9.9-2.1.9ZM24 31.15q-3.15 0-5.15-2-2-2-2-5.15 0-3.15 2-5.15 2-2 5.15-2 3.15 0 5.15 2 2 2 2 5.15 0 3.15-2 5.15-2 2-5.15 2ZM6 17.6V9q0-1.2.9-2.1Q7.8 6 9 6h8.6v3H9v8.6Zm33 0V9h-8.6V6H39q1.2 0 2.1.9.9.9.9 2.1v8.6Z",p.zoomIn="M39.8 41.95 26.65 28.8q-1.5 1.3-3.5 2.025-2 .725-4.25.725-5.4 0-9.15-3.75T6 18.75q0-5.3 3.75-9.05 3.75-3.75 9.1-3.75 5.3 0 9.025 3.75 3.725 3.75 3.725 9.05 0 2.15-.7 4.15-.7 2-2.1 3.75L42 39.75Zm-20.95-13.4q4.05 0 6.9-2.875Q28.6 22.8 28.6 18.75t-2.85-6.925Q22.9 8.95 18.85 8.95q-4.1 0-6.975 2.875T9 18.75q0 4.05 2.875 6.925t6.975 2.875ZM17.3 24.3v-4.1h-4.1v-3h4.1v-4.05h3v4.05h4.05v3H20.3v4.1Z",p.zoomOut="M39.8 41.95 26.65 28.8q-1.5 1.3-3.5 2.025-2 .725-4.25.725-5.4 0-9.15-3.75T6 18.75q0-5.3 3.75-9.05 3.75-3.75 9.1-3.75 5.3 0 9.025 3.75 3.725 3.75 3.725 9.05 0 2.15-.7 4.15-.7 2-2.1 3.75L42 39.75Zm-20.95-13.4q4.05 0 6.9-2.875Q28.6 22.8 28.6 18.75t-2.85-6.925Q22.9 8.95 18.85 8.95q-4.1 0-6.975 2.875T9 18.75q0 4.05 2.875 6.925t6.975 2.875Zm-5.1-8.35v-3H23.8v3Z",p.undo="M14 38v-3h14.45q3.5 0 6.025-2.325Q37 30.35 37 26.9t-2.525-5.775Q31.95 18.8 28.45 18.8H13.7l5.7 5.7-2.1 2.1L8 17.3 17.3 8l2.1 2.1-5.7 5.7h14.7q4.75 0 8.175 3.2Q40 22.2 40 26.9t-3.425 7.9Q33.15 38 28.4 38Z",p.redo="M19.6 38q-4.75 0-8.175-3.2Q8 31.6 8 26.9t3.425-7.9q3.425-3.2 8.175-3.2h14.7l-5.7-5.7L30.7 8l9.3 9.3-9.3 9.3-2.1-2.1 5.7-5.7H19.55q-3.5 0-6.025 2.325Q11 23.45 11 26.9t2.525 5.775Q16.05 35 19.55 35H34v3Z",p.move="m24 44-8.15-8.15 2.2-2.2 4.45 4.45v-9.45h3v9.45l4.45-4.45 2.2 2.2ZM11.9 31.9 4 24l7.95-7.95 2.2 2.2L9.9 22.5h9.45v3H9.9l4.2 4.2Zm24.2 0-2.2-2.2 4.2-4.2h-9.4v-3h9.4l-4.2-4.2 2.2-2.2L44 24ZM22.5 19.3V9.9l-4.2 4.2-2.2-2.2L24 4l7.9 7.9-2.2 2.2-4.2-4.2v9.4Z",p.delete="m16.5 33.6 7.5-7.5 7.5 7.5 2.1-2.1-7.5-7.5 7.5-7.5-2.1-2.1-7.5 7.5-7.5-7.5-2.1 2.1 7.5 7.5-7.5 7.5ZM24 44q-4.1 0-7.75-1.575-3.65-1.575-6.375-4.3-2.725-2.725-4.3-6.375Q4 28.1 4 24q0-4.15 1.575-7.8 1.575-3.65 4.3-6.35 2.725-2.7 6.375-4.275Q19.9 4 24 4q4.15 0 7.8 1.575 3.65 1.575 6.35 4.275 2.7 2.7 4.275 6.35Q44 19.85 44 24q0 4.1-1.575 7.75-1.575 3.65-4.275 6.375t-6.35 4.3Q28.15 44 24 44Z",p.folderUp="M22.5 34h3V23.75l3.7 3.7 2.1-2.1-7.3-7.3-7.3 7.3 2.1 2.1 3.7-3.7ZM7.05 40q-1.2 0-2.1-.925-.9-.925-.9-2.075V11q0-1.15.9-2.075Q5.85 8 7.05 8h14l3 3h17q1.15 0 2.075.925.925.925.925 2.075v23q0 1.15-.925 2.075Q42.2 40 41.05 40Zm0-29v26h34V14H22.8l-3-3H7.05Zm0 0v26Z",p.close="m12.45 37.65-2.1-2.1L21.9 24 10.35 12.45l2.1-2.1L24 21.9l11.55-11.55 2.1 2.1L26.1 24l11.55 11.55-2.1 2.1L24 26.1Z",p.options="m19.4 44-1-6.3q-.95-.35-2-.95t-1.85-1.25l-5.9 2.7L4 30l5.4-3.95q-.1-.45-.125-1.025Q9.25 24.45 9.25 24q0-.45.025-1.025T9.4 21.95L4 18l4.65-8.2 5.9 2.7q.8-.65 1.85-1.25t2-.9l1-6.35h9.2l1 6.3q.95.35 2.025.925Q32.7 11.8 33.45 12.5l5.9-2.7L44 18l-5.4 3.85q.1.5.125 1.075.025.575.025 1.075t-.025 1.05q-.025.55-.125 1.05L44 30l-4.65 8.2-5.9-2.7q-.8.65-1.825 1.275-1.025.625-2.025.925l-1 6.3ZM24 30.5q2.7 0 4.6-1.9 1.9-1.9 1.9-4.6 0-2.7-1.9-4.6-1.9-1.9-4.6-1.9-2.7 0-4.6 1.9-1.9 1.9-1.9 4.6 0 2.7 1.9 4.6 1.9 1.9 4.6 1.9Z",p.expand="m24 30.75-12-12 2.15-2.15L24 26.5l9.85-9.85L36 18.8Z",p.alert="M24 42q-1.45 0-2.475-1.025Q20.5 39.95 20.5 38.5q0-1.45 1.025-2.475Q22.55 35 24 35q1.45 0 2.475 1.025Q27.5 37.05 27.5 38.5q0 1.45-1.025 2.475Q25.45 42 24 42Zm-3.5-12V6h7v24Z",p.play="M14.75 40.15V7.55l25.6 16.3Z",p.stop="M10.75 37.25V10.7H37.3v26.55Z",p.folder="M7.05 40q-1.2 0-2.1-.925-.9-.925-.9-2.075V11q0-1.15.9-2.075Q5.85 8 7.05 8h14l3 3h17q1.15 0 2.075.925.925.925.925 2.075v23q0 1.15-.925 2.075Q42.2 40 41.05 40Z";class u{static deepClone(t){return void 0!==window.structuredClone?window.structuredClone(t):JSON.parse(JSON.stringify(t))}}class g{static next(){const t=new Uint8Array(16);return window.crypto.getRandomValues(t),Array.from(t,(t=>t.toString(16).padStart(2,"0"))).join("")}}!function(t){t[t.singleSequence=1]="singleSequence",t[t.branches=2]="branches"}(o||(o={}));class v{constructor(t){this.stepExtensionResolver=t}getChildren(t){return this.stepExtensionResolver.resolve(t.componentType).getChildren(t)}find(t,e,n,s){if(e&&t===e)return!0;const i=t.length;for(let r=0;r<i;r++){const i=t[r];if(n&&i.id===n)return s.push({step:i,index:r,parentSequence:t}),!0;const a=this.getChildren(i);if(a)switch(a.type){case o.singleSequence:{const t=a.sequences;if(this.find(t,e,n,s))return s.push({step:i,index:r,parentSequence:t}),!0}break;case o.branches:{const t=a.sequences,o=Object.keys(t);for(const a of o){const o=t[a];if(this.find(o,e,n,s))return s.push(a),s.push({step:i,index:r,parentSequence:o}),!0}}break;default:throw new Error(`Step children type ${a.type} is not supported`)}}return!1}getParents(t,e){const n=[],s=Array.isArray(e)?e:null,i=s?null:e.id;if(this.find(t.sequence,s,i,n))return n.reverse(),n.map((t=>"string"==typeof t?t:t.step));throw new Error(i?`Cannot get parents of step: ${i}`:"Cannot get parents of sequence")}findParentSequence(t,e){const n=[];return this.find(t.sequence,null,e,n)?n[0]:null}getParentSequence(t,e){const n=this.findParentSequence(t,e);if(!n)throw new Error(`Cannot find step by id: ${e}`);return n}findById(t,e){const n=this.findParentSequence(t,e);return n?n.step:null}getById(t,e){return this.getParentSequence(t,e).step}getChildAndParentSequences(t,e){const n=this.getParentSequence(t,e),s=this.getChildren(n.step);if(!s||s.type!==o.singleSequence)throw new Error(`Cannot find single sequence in step: ${e}`);const i=s.sequences;return{index:n.index,parentSequence:n.parentSequence,childSequence:i}}}function m(t,n,s,i){const o=[void 0,void 0,void 0],r=new e;let a=!1;return[n,s,i].filter((t=>t)).forEach(((e,n)=>{e.subscribe((e=>{o[n]=e,a||(a=!0,setTimeout((()=>{try{r.forward(o)}finally{a=!1,o.fill(void 0)}}),t))}))})),r}class w{static create(t,e,n){const s=new w(t,e,n);return m(0,t.onDefinitionChanged,t.onSelectedStepIdChanged).subscribe((t=>{const[e,n]=t;e?s.onDefinitionChanged(e):void 0!==n&&s.onSelectedStepIdChanged(n)})),s.tryRender(t.selectedStepId),s}constructor(t,e,n){this.state=t,this.stepsTraverser=e,this.handler=n,this.currentStepId=void 0}destroy(){}render(t){const e=t?this.stepsTraverser.getById(this.state.definition,t):null;this.currentStepId=t,this.handler(e)}tryRender(t){this.currentStepId!==t&&this.render(t)}onDefinitionChanged(t){t.changeType===i.rootReplaced?this.render(this.state.selectedStepId):this.tryRender(this.state.selectedStepId)}onSelectedStepIdChanged(t){this.tryRender(t)}}class C{constructor(t,e,n,s){this.state=t,this.stepsTraverser=e,this.layoutController=n,this.definitionModifier=s}isVisibleAtStart(){return this.layoutController.isMobile()}getDefinition(){return this.state.definition}runRenderer(t){return w.create(this.state,this.stepsTraverser,t)}createStepEditorContext(t){if(!t)throw new Error("Step id is empty");return{notifyPropertiesChanged:()=>{this.state.notifyDefinitionChanged(i.stepPropertyChanged,t)},notifyNameChanged:()=>{this.state.notifyDefinitionChanged(i.stepNameChanged,t)},notifyChildrenChanged:()=>{this.state.notifyDefinitionChanged(i.stepChildrenChanged,t),this.definitionModifier.updateDependantFields()}}}createGlobalEditorContext(){return{notifyPropertiesChanged:()=>{this.state.notifyDefinitionChanged(i.globalPropertyChanged,null)}}}}class f{constructor(t,e){this.state=t,this.stepsTraverser=e}subscribe(t){m(0,this.state.onFolderPathChanged,this.state.onDefinitionChanged).subscribe(t)}setFolderPath(t){this.state.setFolderPath(t)}getFolderPath(){return this.state.folderPath}getFolderPathStepNames(){return this.state.folderPath.map((t=>this.stepsTraverser.getById(this.state.definition,t).name))}}class b{static create(t,e,n){const s=e.theme||"light",i=h.element("div",{class:`sqd-drag sqd-theme-${s}`});document.body.appendChild(i);const o=n.services.draggedComponent.create(i,t,n);return new b(o,i)}constructor(t,e){this.component=t,this.layer=e}setPosition(t){this.layer.style.top=t.y+"px",this.layer.style.left=t.x+"px"}remove(){this.component.destroy(),document.body.removeChild(this.layer)}}class q{static create(t,e){const n=new q(t,e);return e.onViewportChanged.subscribe(n.clearCacheHandler),window.addEventListener("scroll",n.clearCacheHandler,!1),n}constructor(t,e){this.placeholders=t,this.state=e,this.clearCacheHandler=()=>this.clearCache()}find(t,e,n){var i;if(!this.cache){const t=new s(window.scrollX,window.scrollY);this.cache=this.placeholders.map((e=>{const n=e.getClientRect();return{placeholder:e,lt:new s(n.x,n.y).add(t),br:new s(n.x+n.width,n.y+n.height).add(t)}})),this.cache.sort(((t,e)=>t.lt.y-e.lt.y))}const o=t.x+e,r=t.y+n;return null===(i=this.cache.find((e=>Math.max(t.x,e.lt.x)<Math.min(o,e.br.x)&&Math.max(t.y,e.lt.y)<Math.min(r,e.br.y))))||void 0===i?void 0:i.placeholder}destroy(){this.state.onViewportChanged.unsubscribe(this.clearCacheHandler),window.removeEventListener("scroll",this.clearCacheHandler,!1)}clearCache(){this.cache=void 0}}class x{static create(t,e,n){const s=b.create(e,t.configuration,t.componentContext);return new x(s,t.workspaceController,t.state,e,t.definitionModifier,n)}constructor(t,e,n,s,i,o){this.view=t,this.workspaceController=e,this.designerState=n,this.step=s,this.definitionModifier=i,this.draggedStepComponent=o}onStart(t){let e=null;if(this.draggedStepComponent&&(this.draggedStepComponent.setIsDisabled(!0),this.draggedStepComponent.view.width===this.view.component.width&&this.draggedStepComponent.view.height===this.view.component.height)){const n=new s(window.scrollX,window.scrollY),i=this.draggedStepComponent.view.getClientPosition().add(n);e=t.subtract(i)}e||(e=new s(this.view.component.width,this.view.component.height).divideByScalar(2)),this.view.setPosition(t.subtract(e)),this.designerState.setIsDragging(!0);const n=this.workspaceController.getPlaceholders();this.state={startPosition:t,finder:q.create(n,this.designerState),offset:e}}onMove(t){if(this.state){const e=this.state.startPosition.subtract(t).subtract(this.state.offset);this.view.setPosition(e);const n=this.state.finder.find(e,this.view.component.width,this.view.component.height);this.currentPlaceholder!==n&&(this.currentPlaceholder&&this.currentPlaceholder.setIsHover(!1),n&&n.setIsHover(!0),this.currentPlaceholder=n)}}onEnd(t){if(!this.state)throw new Error("Invalid state");this.state.finder.destroy(),this.state=void 0,this.view.remove(),this.designerState.setIsDragging(!1);let e=!1;!t&&this.currentPlaceholder&&(e=this.draggedStepComponent?this.definitionModifier.tryMove(this.draggedStepComponent.parentSequence,this.draggedStepComponent.step,this.currentPlaceholder.parentSequence,this.currentPlaceholder.index):this.definitionModifier.tryInsert(this.step,this.currentPlaceholder.parentSequence,this.currentPlaceholder.index)),e||(this.draggedStepComponent&&this.draggedStepComponent.setIsDisabled(!1),this.currentPlaceholder&&this.currentPlaceholder.setIsHover(!1)),this.currentPlaceholder=void 0}}class y{constructor(t,e,n,s,i){this.state=t,this.designerContext=e,this.behaviorController=n,this.layoutController=s,this.configuration=i}isVisibleAtStart(){return this.layoutController.isMobile()}tryGetIconUrl(t){return this.configuration.iconUrlProvider?this.configuration.iconUrlProvider(t.componentType,t.type):null}tryDrag(t,e){if(!this.state.isReadonly){const n=function(t){const e=u.deepClone(t);return e.id=g.next(),e}(e);return this.behaviorController.start(t,x.create(this.designerContext,n)),!0}return!1}}class S{constructor(t,e){this.workspaceController=t,this.viewportController=e}resetViewport(){this.viewportController.setDefault()}zoom(t){this.viewportController.zoom(t)}moveViewportToStep(t){const e=this.workspaceController.getComponentByStepId(t),n=e.view.getClientPosition(),i=new s(e.view.width,e.view.height);this.viewportController.focusOnComponent(n,i)}}class I{constructor(t,e){this.state=t,this.workspaceController=e}getCanvasPosition(){return this.workspaceController.getCanvasPosition()}getCanvasSize(){return this.workspaceController.getCanvasSize()}getRootComponentSize(){return this.workspaceController.getRootComponentSize()}getViewport(){return this.state.viewport}setViewport(t){this.state.setViewport(t)}updateRootComponent(){this.workspaceController.updateRootComponent()}updateBadges(){this.workspaceController.updateBadges()}updateCanvasSize(){this.workspaceController.updateCanvasSize()}}class k{static create(e){const n=new I(e.state,e.workspaceController),s=e.services.viewportController.create(n),i=new S(e.workspaceController,s);return new k(new t(e.state,e.historyController,e.definitionModifier,i),new y(e.state,e,e.behaviorController,e.layoutController,e.configuration.steps),new C(e.state,e.stepsTraverser,e.layoutController,e.definitionModifier),n,i,new f(e.state,e.stepsTraverser))}constructor(t,e,n,s,i,o){this.controlBar=t,this.toolbox=e,this.editor=n,this.workspace=s,this.viewport=i,this.pathBar=o}}class D{static create(t,e,n){const s=h.svg("g",{class:"sqd-badges"});e.g.appendChild(s);const i=n.services.badges.map((e=>e.createBadge(s,t,n)));return new D(s,e,i)}constructor(t,e,n){this.g=t,this.view=e,this.badges=n}update(t){const e=this.badges.length;for(let n=0;n<e;n++)t[n]=this.badges[n].update(t[n]);let n=0,s=0,i=0;for(let t=0;t<e;t++){const e=this.badges[t];e.view&&(n+=0===i?e.view.width/2:e.view.width,s=Math.max(s,e.view.height),h.translate(e.view.g,-n,0),n+=4,i++)}h.translate(this.g,this.view.width,-s/2)}resolveClick(t){for(const e of this.badges){const n=e.resolveClick(t);if(n)return n}return null}}(l=r||(r={}))[l.selectStep=1]="selectStep",l[l.rerenderStep=2]="rerenderStep",l[l.openFolder=3]="openFolder",l[l.triggerCustomAction=4]="triggerCustomAction",(d=a||(a={}))[d.none=0]="none",d[d.in=1]="in",d[d.out=2]="out";class B{static create(t,e,n){const s=D.create(e,t,n);return new B(t,e.step,e.parentSequence,t.hasOutput(),s)}constructor(t,e,n,s,i){this.view=t,this.step=e,this.parentSequence=n,this.hasOutput=s,this.badges=i,this.isDisabled=!1}findById(t){if(this.step.id===t)return this;if(this.view.sequenceComponents)for(const e of this.view.sequenceComponents){const n=e.findById(t);if(n)return n}return null}resolveClick(t){if(this.view.sequenceComponents)for(const e of this.view.sequenceComponents){const n=e.resolveClick(t);if(n)return n}const e=this.badges.resolveClick(t);if(e)return e;const n=this.view.resolveClick(t);return n?!0===n?{type:r.selectStep,component:this}:n:null}getPlaceholders(t){this.isDisabled||(this.view.sequenceComponents&&this.view.sequenceComponents.forEach((e=>e.getPlaceholders(t))),this.view.placeholders&&this.view.placeholders.forEach((e=>t.push(e))))}setIsDragging(t){this.isDisabled||(this.view.sequenceComponents&&this.view.sequenceComponents.forEach((e=>e.setIsDragging(t))),this.view.placeholders&&this.view.placeholders.forEach((e=>e.setIsVisible(t)))),this.view.setIsDragging(t)}setIsSelected(t){this.view.setIsSelected(t)}setIsDisabled(t){this.isDisabled=t,this.view.setIsDisabled(t)}updateBadges(t){this.view.sequenceComponents&&this.view.sequenceComponents.forEach((e=>e.updateBadges(t))),this.badges.update(t)}}class z{static create(t,e){const n=e.configuration.iconUrlProvider;return{getStepIconUrl:n?()=>n(t.step.componentType,t.step.type):()=>null,createSequenceComponent:(n,s)=>{const i={sequence:s,depth:t.depth+1,isInputConnected:!0,isOutputConnected:t.isOutputConnected};return e.services.sequenceComponent.create(n,i,e)},createPlaceholderForArea:e.services.placeholder.createForArea.bind(e.services.placeholder)}}}class P{constructor(t){this.stepExtensionResolver=t}create(t,e,n){const s=z.create(e,n),i=this.stepExtensionResolver.resolve(e.step.componentType).createComponentView(t,e,s),o=n.services.stepComponentViewWrapper.wrap(i,e);return B.create(o,e,n)}}class E{static create(t,e,n){const s=n.placeholderController.create(),i=new P(e);return new E(t,s,i,n)}constructor(t,e,n,s){this.configuration=t,this.placeholderController=e,this.stepComponentFactory=n,this.services=s}}class M{static create(t){return new M(t)}constructor(t){this.parent=t,this.currentContainer=null}setContent(t,e){const n=h.element("div",{class:e});n.appendChild(t),this.currentContainer&&this.parent.removeChild(this.currentContainer),this.parent.appendChild(n),this.currentContainer=n}destroy(){this.currentContainer&&this.parent.removeChild(this.currentContainer)}}class T{static create(t,e,n,s,i,o){const r=M.create(t),a=e.editor.runRenderer((t=>function(t){let a,d;if(t){const i=e.editor.createStepEditorContext(t.id);a=s(t,i),d=n}else{const t=e.editor.createGlobalEditorContext();a=o(e.editor.getDefinition(),t),d=i}r.setContent(a,d)}(t)));return new T(r,a)}constructor(t,e){this.view=t,this.renderer=e}destroy(){this.view.destroy(),this.renderer.destroy()}}class R{static create(t,e){const n=h.svg("g"),s=e.size/2,i=h.svg("path",{class:"sqd-validation-error",d:`M 0 ${-s} l ${s} ${e.size} l ${-e.size} 0 Z`});h.translate(i,s,s),n.appendChild(i);const o=p.appendPath(n,"sqd-validation-error-icon-path",p.alert,e.iconSize),r=.5*(e.size-e.iconSize),a=1.5*r;return h.translate(o,r,a),t.appendChild(n),new R(t,n,e.size,e.size)}constructor(t,e,n,s){this.parent=t,this.g=e,this.width=n,this.height=s}destroy(){this.parent.removeChild(this.g)}}class L{static create(t,e,n,s){return new L(t,e,n.configuration.validator,s)}constructor(t,e,n,s){this.parentElement=t,this.stepContext=e,this.validator=n,this.configuration=s,this.view=null}update(t){const e=!this.validator||this.validator(this.stepContext.step,this.stepContext.parentSequence);return e?this.view&&(this.view.destroy(),this.view=null):this.view||(this.view=R.create(this.parentElement,this.configuration)),e&&t}resolveClick(){return null}}const F={view:{size:22,iconSize:12}};class V{static create(t){return new V(null!=t?t:F)}constructor(t){this.configuration=t,this.id="validationError",this.createStartValue=()=>!0}createBadge(t,e,n){return L.create(t,e,n,this.configuration.view)}}class H{static createRectInput(t,e,n,s,i,o){const r=h.svg("g");t.appendChild(r);const a=h.svg("rect",{class:"sqd-input",width:s,height:s,x:e-s/2,y:n+s/-2+.5,rx:4,ry:4});if(r.appendChild(a),o){const t=h.svg("image",{href:o,width:i,height:i,x:e-i/2,y:n+i/-2});r.appendChild(t)}return new H(r)}static createRoundInput(t,e,n,s){const i=h.svg("circle",{class:"sqd-input",cx:e,xy:n,r:s/2});return t.appendChild(i),new H(i)}constructor(t){this.root=t}setIsHidden(t){h.attrs(this.root,{visibility:t?"hidden":"visible"})}}class A{static createStraightJoin(t,e,n){const s=h.svg("line",{class:"sqd-join",x1:e.x,y1:e.y,x2:e.x,y2:e.y+n});t.insertBefore(s,t.firstChild)}static createJoins(t,e,n){const s=n[0],i=Math.abs(s.y-e.y)/2,o=Math.sign(s.y-e.y);switch(n.length){case 1:e.x===n[0].x?A.createStraightJoin(t,e,s.y*o):O(t,e,n,i,o);break;case 2:O(t,e,n,i,o);break;default:{const s=n[0],r=n[n.length-1];Z(t,`M ${s.x} ${s.y} q ${.3*i} ${i*-o*.8} ${i} ${i*-o} l ${r.x-s.x-2*i} 0 q ${.8*i} ${-i*-o*.3} ${i} ${-i*-o}`);for(let e=1;e<n.length-1;e++)A.createStraightJoin(t,n[e],i*-o);A.createStraightJoin(t,e,i*o)}}}}function O(t,e,n,s,i){for(const o of n){const n=Math.abs(o.x-e.x)-2*s,r=Math.sign(o.x-e.x);Z(t,`M ${e.x} ${e.y} q ${r*s*.3} ${i*s*.8} ${r*s} ${i*s} l ${r*n} 0 q ${r*s*.7} ${i*s*.2} ${r*s} ${i*s}`)}}function Z(t,e){const n=h.svg("path",{class:"sqd-join",fill:"none",d:e});t.insertBefore(n,t.firstChild)}class X{static create(t,e,n,s,i){const o=h.svg("g",{class:`sqd-label sqd-label-${i}`});t.appendChild(o);const r=h.svg("text",{class:"sqd-label-text",y:e+n.height/2});r.textContent=s,o.appendChild(r);const a=Math.max(r.getBBox().width+2*n.paddingX,n.minWidth),d=h.svg("rect",{class:"sqd-label-rect",width:a,height:n.height,x:-a/2+.5,y:e+.5,rx:n.radius,ry:n.radius});return o.insertBefore(d,r),new X(o,a,n.height)}constructor(t,e,n){this.g=t,this.width=e,this.height=n}}class U{static create(t,e,n,s){const i=h.svg("circle",{class:"sqd-output",cx:e,cy:n,r:s/2});return t.appendChild(i),new U(i)}constructor(t){this.root=t}setIsHidden(t){h.attrs(this.root,{visibility:t?"hidden":"visible"})}}class ${static create(t,e,n){const s=e.reduce(((t,e)=>t+e),0),i=[W(t,0,0,s,0),W(t,0,0,0,n),W(t,0,n,s,n),W(t,s,0,s,n)];let o=e[0];for(let s=1;s<e.length;s++)i.push(W(t,o,0,o,n)),o+=e[s];return new $(i,s,n)}constructor(t,e,n){this.lines=t,this.width=e,this.height=n}getClientPosition(){const t=this.lines[0].getBoundingClientRect();return new s(t.x,t.y)}resolveClick(t){const e=this.getClientPosition(),n=t.position.subtract(e);return n.x>=0&&n.y>=0&&n.x<this.width*t.scale&&n.y<this.height*t.scale}setIsSelected(t){this.lines.forEach((e=>{h.toggleClass(e,t,"sqd-selected")}))}}function W(t,e,n,s,i){const o=h.svg("line",{class:"sqd-region",x1:e,y1:n,x2:s,y2:i});return t.insertBefore(o,t.firstChild),o}class j{static create(t,e,n,s,i,o){const r=h.svg("g",{visibility:"hidden",class:"sqd-placeholder"});t.appendChild(r);const d=h.svg("rect",{class:"sqd-placeholder-rect",width:e,height:n,rx:s,ry:s});if(r.appendChild(d),o){const t=o===a.in?p.folderIn:p.folderOut,s=p.appendPath(r,"sqd-placeholder-icon-path",t,i);h.translate(s,(e-i)/2,(n-i)/2)}return t.appendChild(r),new j(d,r)}constructor(t,e){this.rect=t,this.g=e}setIsHover(t){h.toggleClass(this.g,t,"sqd-hover")}setIsVisible(t){h.attrs(this.g,{visibility:t?"visible":"hidden"})}}class N{static create(t,e,n){const i=n.services.placeholder.gapSize.x,o=n.services.placeholder.gapSize.y,{sequence:r}=e,a=h.svg("g");t.appendChild(a);const d=[];for(let t=0;t<r.length;t++){const s={parentSequence:e.sequence,step:r[t],depth:e.depth,position:t,isInputConnected:0===t?e.isInputConnected:d[t-1].hasOutput,isOutputConnected:t!==r.length-1||e.isOutputConnected};d[t]=n.stepComponentFactory.create(a,s,n)}let l,c;if(d.length>0){const t=Math.max(...d.map((t=>t.view.width-t.view.joinX)));l=Math.max(...d.map((t=>t.view.joinX))),c=l+t}else l=i/2,c=i;let p=o;const u=[];for(let t=0;t<d.length;t++){const c=d[t],g=l-c.view.joinX;if((0===t&&e.isInputConnected||t>0&&d[t-1].hasOutput)&&A.createStraightJoin(a,new s(l,p-o),o),n.placeholderController.canCreate(r,t)){const e=n.services.placeholder.createForGap(a,r,t);h.translate(e.view.g,l-i/2,p-o),u.push(e)}h.translate(c.view.g,g,p),p+=c.view.height+o}e.isOutputConnected&&(0===d.length||d[d.length-1].hasOutput)&&A.createStraightJoin(a,new s(l,p-o),o);const g=d.length;if(n.placeholderController.canCreate(r,g)){const t=n.services.placeholder.createForGap(a,r,g);h.translate(t.view.g,l-i/2,p-o),u.push(t)}return new N(a,c,p,l,u,d)}constructor(t,e,n,s,i,o){this.g=t,this.width=e,this.height=n,this.joinX=s,this.placeholders=i,this.components=o}setIsDragging(t){this.placeholders.forEach((e=>{e.setIsVisible(t)}))}hasOutput(){return!(this.components.length>0)||this.components[this.components.length-1].hasOutput}}class Q{static create(t,e,n){const s=N.create(t,e,n);return new Q(s,s.hasOutput())}constructor(t,e){this.view=t,this.hasOutput=e}resolveClick(t){for(const e of this.view.components){const n=e.resolveClick(t);if(n)return n}for(const e of this.view.placeholders){const n=e.resolveClick(t);if(n)return n}return null}findById(t){for(const e of this.view.components){const n=e.findById(t);if(n)return n}return null}getPlaceholders(t){this.view.placeholders.forEach((e=>t.push(e))),this.view.components.forEach((e=>e.getPlaceholders(t)))}setIsDragging(t){this.view.setIsDragging(t),this.view.components.forEach((e=>e.setIsDragging(t)))}updateBadges(t){for(const e of this.view.components)e.updateBadges(t)}}const Y=(t,e)=>(n,i,o)=>{const{step:r}=i,a=h.svg("g",{class:`sqd-step-task sqd-type-${r.type}`});n.appendChild(a);const d=2*e.paddingY+e.iconSize,l=h.svg("text",{x:e.paddingLeft+e.iconSize+e.textMarginLeft,y:d/2,class:"sqd-step-task-text"});l.textContent=r.name,a.appendChild(l);const c=Math.max(l.getBBox().width,e.minTextWidth),p=e.iconSize+e.paddingLeft+e.paddingRight+e.textMarginLeft+c,u=h.svg("rect",{x:.5,y:.5,class:"sqd-step-task-rect",width:p,height:d,rx:e.radius,ry:e.radius});a.insertBefore(u,l);const g=o.getStepIconUrl(),v=g?h.svg("image",{href:g}):h.svg("rect",{class:"sqd-step-task-empty-icon",rx:e.radius,ry:e.radius});h.attrs(v,{x:e.paddingLeft,y:e.paddingY,width:e.iconSize,height:e.iconSize}),a.appendChild(v);const m=0===i.depth&&0===i.position&&!i.isInputConnected,w=t,C=m?null:H.createRoundInput(a,p/2,0,e.inputSize),f=w?null:U.create(a,p/2,d,e.outputSize);return{g:a,width:p,height:d,joinX:p/2,sequenceComponents:null,placeholders:null,hasOutput:()=>!!f,getClientPosition(){const t=u.getBoundingClientRect();return new s(t.x,t.y)},resolveClick:t=>!!a.contains(t.element)||null,setIsDragging(t){null==C||C.setIsHidden(t),null==f||f.setIsHidden(t)},setIsDisabled(t){h.toggleClass(a,t,"sqd-disabled")},setIsSelected(t){h.toggleClass(u,t,"sqd-selected")}}};class G{static center(t,e,n){const i=Math.max(e.x-2*t,0),o=Math.max(e.y-2*t,0),r=Math.min(Math.min(i/n.x,o/n.y),1),a=n.x*r,d=n.y*r,l=Math.max(0,(e.x-a)/2),c=Math.max(0,(e.y-d)/2);return{position:new s(l,c),scale:r}}static focusOnComponent(t,e,n,s){const i=e.position.divideByScalar(e.scale).subtract(n.divideByScalar(e.scale)),o=s.divideByScalar(2);return{position:i.add(t.divideByScalar(2)).subtract(o),scale:1}}}const J=new class{constructor(t){this.values=t}next(t,e){let n,s=0,i=Number.MAX_VALUE;for(let e=0;e<this.values.length;e++){const n=Math.abs(this.values[e]-t);i>n&&(s=e,i=n)}return n=e?Math.min(s+1,this.values.length-1):Math.max(s-1,0),{current:this.values[s],next:this.values[n]}}}([.06,.08,.1,.12,.16,.2,.26,.32,.4,.5,.6,.7,.8,.9,1]);class _{static zoom(t,e){const n=J.next(t.scale,e);return{position:t.position,scale:n.next}}static zoomByWheel(t,e,n){if(0===e.deltaY)return null;const i=J.next(t.scale,e.deltaY<0);let o;const r=Math.abs(e.deltaY);if(r<16){const e=r/16,n=i.next-i.current;o=t.scale+n*e}else o=i.next;const a=new s(e.pageX,e.pageY).subtract(n);return{position:a.divideByScalar(t.scale).subtract(t.position.divideByScalar(t.scale)).multiplyByScalar(-o).add(a),scale:o}}}class K{static create(t){return new K(t)}constructor(t){this.api=t}onWheel(t){const e=this.api.getViewport(),n=this.api.getCanvasPosition(),s=_.zoomByWheel(e,t,n);s&&this.api.setViewport(s)}}class tt{constructor(){this.create=K.create}}class et{constructor(t){this.api=t}execute(t){this.animation&&this.animation.isAlive&&this.animation.stop();const e=this.api.getViewport(),n=e.position,s=e.scale,i=n.subtract(t.position),o=s-t.scale;this.animation=function(t,e){const n=setInterval((function(){const t=Math.min((Date.now()-s)/150,1);e(t),1===t&&i.stop()}),15),s=Date.now(),i={isAlive:!0,stop:()=>{i.isAlive=!1,clearInterval(n)}};return i}(0,(t=>{const e=s-o*t;this.api.setViewport({position:n.subtract(i.multiplyByScalar(t)),scale:e})}))}}class nt{static create(t){return new nt(t)}constructor(t){this.api=t,this.animator=new et(this.api)}setDefault(){const t=this.api.getRootComponentSize(),e=this.api.getCanvasSize(),n=G.center(10,e,t);this.api.setViewport(n)}zoom(t){const e=this.api.getViewport(),n=_.zoom(e,t);this.api.setViewport(n)}focusOnComponent(t,e){const n=this.api.getViewport(),s=this.api.getCanvasSize(),i=G.focusOnComponent(s,n,t,e);this.animateTo(i)}animateTo(t){this.animator.execute(t)}}class st{constructor(){this.create=nt.create}}class it{static create(t){const e={};for(let n=t.steps.length-1;n>=0;n--){const s=t.steps[n];e[s.componentType]=s}return new it(e)}constructor(t){this.dict=t}resolve(t){const e=this.dict[t];if(!e)throw new Error(`Not supported component type: ${t}`);return e}}class ot{static create(t,e,n,s,i,o){const r=j.create(t,e.x,e.y,o.radius,o.iconSize,n);return new ot(r,s,i)}constructor(t,e,n){this.view=t,this.parentSequence=e,this.index=n}getClientRect(){return this.view.rect.getBoundingClientRect()}setIsHover(t){this.view.setIsHover(t)}setIsVisible(t){this.view.setIsVisible(t)}resolveClick(){return null}}function rt(t){return new s(t.pageX,t.pageY)}function at(t){if(t.touches.length>0){const e=t.touches[0];return new s(e.pageX,e.pageY)}throw new Error("Unknown touch position")}const dt="State is not initialized",lt={passive:!1};class ct{constructor(){this.onMouseMove=t=>{t.preventDefault(),this.move(rt(t))},this.onTouchMove=t=>{t.preventDefault(),this.move(at(t))},this.onMouseUp=t=>{t.preventDefault(),this.stop(!1,t.target)},this.onTouchEnd=t=>{var e;if(t.preventDefault(),!this.state)throw new Error(dt);const n=null!==(e=this.state.lastPosition)&&void 0!==e?e:this.state.startPosition,s=document.elementFromPoint(n.x,n.y);this.stop(!1,s)},this.onTouchStart=t=>{t.preventDefault(),1!==t.touches.length&&this.stop(!0,null)}}start(t,e){this.state?this.stop(!0,null):(this.state={startPosition:t,behavior:e},e.onStart(this.state.startPosition),window.addEventListener("mousemove",this.onMouseMove,!1),window.addEventListener("touchmove",this.onTouchMove,lt),window.addEventListener("mouseup",this.onMouseUp,!1),window.addEventListener("touchend",this.onTouchEnd,lt),window.addEventListener("touchstart",this.onTouchStart,lt))}move(t){if(!this.state)throw new Error(dt);this.state.lastPosition=t;const e=this.state.startPosition.subtract(t),n=this.state.behavior.onMove(e);n&&(this.state.behavior.onEnd(!0,null),this.state.behavior=n,this.state.startPosition=t,this.state.behavior.onStart(this.state.startPosition))}stop(t,e){if(!this.state)throw new Error(dt);window.removeEventListener("mousemove",this.onMouseMove,!1),window.removeEventListener("touchmove",this.onTouchMove,lt),window.removeEventListener("mouseup",this.onMouseUp,!1),window.removeEventListener("touchend",this.onTouchEnd,lt),window.removeEventListener("touchstart",this.onTouchStart,lt),this.state.behavior.onEnd(t,e),this.state=void 0}}class ht{static moveStep(t,e,n,s){const i=t.indexOf(e);if(i<0)throw new Error("Unknown step");const o=t===n;o&&i===s||(t.splice(i,1),o&&i<s&&s--,n.splice(s,0,e))}static insertStep(t,e,n){e.splice(n,0,t)}static deleteStep(t,e){const n=e.indexOf(t);if(n<0)throw new Error("Unknown step");e.splice(n,1)}}class pt{constructor(t,e,n){this.stepsTraverser=t,this.state=e,this.configuration=n}isDeletable(t){if(this.configuration.steps.isDeletable){const e=this.stepsTraverser.getParentSequence(this.state.definition,t);return this.configuration.steps.isDeletable(e.step,e.parentSequence)}return!0}tryDelete(t){const e=this.stepsTraverser.getParentSequence(this.state.definition,t);return!(this.configuration.steps.canDeleteStep&&!this.configuration.steps.canDeleteStep(e.step,e.parentSequence)||(ht.deleteStep(e.step,e.parentSequence),this.state.notifyDefinitionChanged(i.stepDeleted,e.step.id),this.updateDependantFields(),0))}tryInsert(t,e,n){return!(this.configuration.steps.canInsertStep&&!this.configuration.steps.canInsertStep(t,e,n)||(ht.insertStep(t,e,n),this.state.notifyDefinitionChanged(i.stepInserted,t.id),this.state.setSelectedStepId(t.id),0))}isDraggable(t,e){return!this.configuration.steps.isDraggable||this.configuration.steps.isDraggable(t,e)}tryMove(t,e,n,s){return!(this.configuration.steps.canMoveStep&&!this.configuration.steps.canMoveStep(t,e,n,s)||(ht.moveStep(t,e,n,s),this.state.notifyDefinitionChanged(i.stepMoved,e.id),this.state.setSelectedStepId(e.id),0))}replaceDefinition(t){if(!t)throw new Error("Definition is empty");this.state.setDefinition(t),this.updateDependantFields()}updateDependantFields(){this.state.selectedStepId&&(this.stepsTraverser.findById(this.state.definition,this.state.selectedStepId)||this.state.setSelectedStepId(null));for(let t=0;t<this.state.folderPath.length;t++){const e=this.state.folderPath[t];if(!this.stepsTraverser.findById(this.state.definition,e)){const e=this.state.folderPath.slice(0,t);this.state.setFolderPath(e);break}}}}class ut{static create(t,e,n){if(!n.undoStackSize||n.undoStackSize<1)throw new Error("Invalid undo stack size");const s=new ut(t,e,n.undoStackSize);return s.remember(i.rootReplaced,null),t.onDefinitionChanged.subscribe((t=>{t.changeType!==i.rootReplaced&&s.remember(t.changeType,t.stepId)})),s}constructor(t,e,n){this.state=t,this.definitionModifier=e,this.stackSize=n,this.stack=[],this.currentIndex=0}canUndo(){return this.currentIndex>1}undo(){this.currentIndex--,this.commit()}canRedo(){return this.currentIndex<this.stack.length}redo(){this.currentIndex++,this.commit()}remember(t,e){const n=u.deepClone(this.state.definition);if(this.stack.length>0&&this.currentIndex===this.stack.length){const s=this.stack[this.stack.length-1];if(function(t,e,n){return t.changeType===e&&t.stepId===n}(s,t,e))return void(s.definition=n)}this.stack.splice(this.currentIndex),this.stack.push({definition:n,changeType:t,stepId:e}),this.stack.length>this.stackSize&&this.stack.splice(0,this.stack.length-this.stackSize-1),this.currentIndex=this.stack.length}commit(){const t=u.deepClone(this.stack[this.currentIndex-1].definition);this.definitionModifier.replaceDefinition(t)}}class gt{constructor(t){this.parent=t}isMobile(){return this.parent.clientWidth<400}}class vt{set(t){if(this.controller)throw new Error("Controller is already set");this.controller=t}get(){if(!this.controller)throw new Error("Controller is not set");return this.controller}getPlaceholders(){return this.get().getPlaceholders()}getComponentByStepId(t){return this.get().getComponentByStepId(t)}getCanvasPosition(){return this.get().getCanvasPosition()}getCanvasSize(){return this.get().getCanvasSize()}getRootComponentSize(){return this.get().getRootComponentSize()}updateBadges(){this.get().updateBadges()}updateRootComponent(){this.get().updateRootComponent()}updateCanvasSize(){this.get().updateCanvasSize()}}class mt{static create(t,e,n,s){const i=u.deepClone(e),o=new gt(t),r=!!n.isReadonly,a=new c(i,r),d=new vt,l=new ct,h=it.create(s),p=new v(h),g=new pt(p,a,n);let m;n.undoStackSize&&(m=ut.create(a,g,n));const w=E.create(n.steps,h,s);return new mt(a,n,s,w,p,g,o,d,l,m)}constructor(t,e,n,s,i,o,r,a,d,l){this.state=t,this.configuration=e,this.services=n,this.componentContext=s,this.stepsTraverser=i,this.definitionModifier=o,this.layoutController=r,this.workspaceController=a,this.behaviorController=d,this.historyController=l}setWorkspaceController(t){this.workspaceController.set(t)}}let wt=0;class Ct{static create(t,e){const n=h.svg("defs"),s="sqd-grid-pattern-"+wt++,i=h.svg("pattern",{id:s,patternUnits:"userSpaceOnUse"}),o=h.svg("path",{class:"sqd-grid-path",fill:"none"});n.appendChild(i),i.appendChild(o);const r=h.svg("g"),a=h.element("div",{class:"sqd-workspace"}),d=h.svg("svg",{class:"sqd-workspace-canvas"});d.appendChild(n),d.appendChild(h.svg("rect",{width:"100%",height:"100%",fill:`url(#${s})`})),d.appendChild(r),a.appendChild(d),t.appendChild(a);const l=new Ct(a,d,i,o,r,e);return window.addEventListener("resize",l.onResizeHandler,!1),l}constructor(t,e,n,s,i,o){this.workspace=t,this.canvas=e,this.gridPattern=n,this.gridPatternPath=s,this.foreground=i,this.context=o,this.onResizeHandler=()=>this.onResize()}render(t,e){this.rootComponent&&this.foreground.removeChild(this.rootComponent.view.g),this.rootComponent=this.context.services.rootComponent.create(this.foreground,t,e,this.context),this.refreshSize()}setPositionAndScale(t,e){const n=48*e;h.attrs(this.gridPattern,{x:t.x,y:t.y,width:n,height:n}),h.attrs(this.gridPatternPath,{d:`M ${n} 0 L 0 0 0 ${n}`}),h.attrs(this.foreground,{transform:`translate(${t.x}, ${t.y}) scale(${e})`})}getCanvasPosition(){const t=this.canvas.getBoundingClientRect();return new s(t.x+window.scrollX,t.y+window.scrollY)}getCanvasSize(){return new s(this.canvas.clientWidth,this.canvas.clientHeight)}bindClick(t){this.canvas.addEventListener("mousedown",(e=>{e.preventDefault(),t(rt(e),e.target,e.button)}),!1),this.canvas.addEventListener("touchstart",(e=>{e.preventDefault();const n=function(t){if(t.touches.length>0){const e=t.touches[0];return new s(e.clientX,e.clientY)}throw new Error("Unknown touch position")}(e),i=document.elementFromPoint(n.x,n.y);if(i){const n=at(e);t(n,i,0)}}),{passive:!1})}bindContextMenu(t){this.canvas.addEventListener("contextmenu",t,!1)}bindWheel(t){this.canvas.addEventListener("wheel",t,!1)}destroy(){window.removeEventListener("resize",this.onResizeHandler,!1)}refreshSize(){h.attrs(this.canvas,{width:this.workspace.offsetWidth,height:this.workspace.offsetHeight})}onResize(){this.refreshSize()}}class ft{static create(t,e){return new ft(t.viewport.position,e,t)}constructor(t,e,n){this.startPosition=t,this.resetSelectedStep=e,this.state=n}onStart(){if(this.resetSelectedStep){const t=this.state.tryGetLastStepIdFromFolderPath();this.state.setSelectedStepId(t)}}onMove(t){this.state.setViewport({position:this.startPosition.subtract(t),scale:this.state.viewport.scale})}onEnd(){}}class bt{static create(t,e,n){const s=e||n.state.isDragDisabled||!n.definitionModifier.isDraggable(t.step,t.parentSequence);return new bt(t,s,n,n.state)}constructor(t,e,n,s){this.pressedStepComponent=t,this.isDragDisabled=e,this.context=n,this.state=s}onStart(){}onMove(t){if(t.distance()>2)return this.state.isReadonly||this.isDragDisabled?ft.create(this.state,!1):(this.state.setSelectedStepId(null),x.create(this.context,this.pressedStepComponent.step,this.pressedStepComponent))}onEnd(t){t||this.state.setSelectedStepId(this.pressedStepComponent.step.id)}}class qt{static create(t,e){return new qt(t,e)}constructor(t,e){this.clickedElement=t,this.handler=e}onStart(){}onMove(){}onEnd(t,e){!t&&e&&this.clickedElement===e&&this.handler.handle()}}class xt{constructor(t){this.designerContext=t}handle(){this.designerContext.workspaceController.updateRootComponent()}}class yt{constructor(t,e){this.command=t,this.designerContext=e}handle(){const t=this.command.step.id;this.designerContext.state.pushStepIdToFolderPath(t)}}class St{constructor(t,e){this.command=t,this.designerContext=e}handle(){const t=this.designerContext.configuration.customActionHandler;if(!t)return void console.warn(`Custom action handler is not defined (action type: ${this.command.action.type})`);const e=this.createContext();t(this.command.action,this.command.step,this.command.sequence,e)}createContext(){return{notifyStepNameChanged:t=>this.notifyStepChanged(i.stepNameChanged,t),notifyStepPropertiesChanged:t=>this.notifyStepChanged(i.stepPropertyChanged,t),notifyStepInserted:t=>this.notifyStepChanged(i.stepInserted,t),notifyStepMoved:t=>this.notifyStepChanged(i.stepMoved,t),notifyStepDeleted:t=>this.notifyStepChanged(i.stepDeleted,t)}}notifyStepChanged(t,e){if(!e)throw new Error("Step id is empty");this.designerContext.state.notifyDefinitionChanged(t,e)}}class It{constructor(t,e){this.designerContext=t,this.state=e}resolve(t,e,n,s){const i={element:e,position:n,scale:this.state.viewport.scale},o=t.resolveClick(i);if(!o)return ft.create(this.state,!0);switch(o.type){case r.selectStep:return bt.create(o.component,s,this.designerContext);case r.rerenderStep:return qt.create(e,new xt(this.designerContext));case r.openFolder:return qt.create(e,new yt(o,this.designerContext));case r.triggerCustomAction:return qt.create(e,new St(o,this.designerContext));default:throw new Error("Not supported behavior type")}}}class kt{static create(t){return t.badges.map((t=>t.createStartValue()))}}function Dt(t){return t.findIndex((t=>"validationError"===t.id))}class Bt{static create(t,e,n){const s=Ct.create(t,e.componentContext),i=new It(e,e.state),o=e.services.wheelController.create(n.workspace),r=new Bt(s,e.stepsTraverser,e.state,e.behaviorController,o,i,n.viewport,e.services);return setTimeout((()=>{r.updateRootComponent(),n.viewport.resetViewport(),r.onReady.forward()})),e.setWorkspaceController(r),e.state.onViewportChanged.subscribe((t=>r.onViewportChanged(t))),e.state.onIsDraggingChanged.subscribe((t=>r.onIsDraggingChanged(t))),m(0,e.state.onDefinitionChanged,e.state.onSelectedStepIdChanged,e.state.onFolderPathChanged).subscribe((t=>{r.onStateChanged(t[0],t[1],t[2])})),s.bindClick(((t,e,n)=>r.onClick(t,e,n))),s.bindWheel((t=>r.onWheel(t))),s.bindContextMenu((t=>r.onContextMenu(t))),r}constructor(t,n,s,i,o,r,a,d){this.view=t,this.stepsTraverser=n,this.state=s,this.behaviorController=i,this.wheelController=o,this.clickBehaviorResolver=r,this.viewportApi=a,this.services=d,this.onReady=new e,this.isValid=!1,this.selectedStepComponent=null,this.validationErrorBadgeIndex=null}updateRootComponent(){let t,e;this.selectedStepComponent=null;const n=this.state.tryGetLastStepIdFromFolderPath();if(n){const s=this.stepsTraverser.getChildAndParentSequences(this.state.definition,n);e=s.childSequence,t={sequence:s.parentSequence,index:s.index}}else e=this.state.definition.sequence,t=null;this.view.render(e,t),this.trySelectStepComponent(this.state.selectedStepId),this.updateBadges()}updateBadges(){const t=kt.create(this.services);this.getRootComponent().updateBadges(t),null===this.validationErrorBadgeIndex&&(this.validationErrorBadgeIndex=Dt(this.services.badges)),this.isValid=Boolean(t[this.validationErrorBadgeIndex])}getPlaceholders(){const t=[];return this.getRootComponent().getPlaceholders(t),t}getComponentByStepId(t){const e=this.getRootComponent().findById(t);if(!e)throw new Error(`Cannot find component for step id: ${t}`);return e}getCanvasPosition(){return this.view.getCanvasPosition()}getCanvasSize(){return this.view.getCanvasSize()}getRootComponentSize(){const t=this.getRootComponent().view;return new s(t.width,t.height)}updateCanvasSize(){setTimeout((()=>this.view.refreshSize()))}destroy(){this.view.destroy()}onClick(t,e,n){const s=1===n;if(0===n||s){const n=this.getRootComponent(),i=s,o=this.clickBehaviorResolver.resolve(n,e,t,i);this.behaviorController.start(t,o)}}onWheel(t){t.preventDefault(),t.stopPropagation(),this.wheelController.onWheel(t)}onContextMenu(t){t.preventDefault()}onIsDraggingChanged(t){this.getRootComponent().setIsDragging(t)}onViewportChanged(t){this.view.setPositionAndScale(t.position,t.scale)}onStateChanged(t,e,n){n?(this.updateRootComponent(),this.viewportApi.resetViewport()):t?t.changeType===i.stepPropertyChanged?this.updateBadges():this.updateRootComponent():void 0!==e&&this.trySelectStepComponent(e)}trySelectStepComponent(t){this.selectedStepComponent&&(this.selectedStepComponent.setIsSelected(!1),this.selectedStepComponent=null),t&&(this.selectedStepComponent=this.getRootComponent().findById(t),this.selectedStepComponent&&this.selectedStepComponent.setIsSelected(!0))}getRootComponent(){if(this.view.rootComponent)return this.view.rootComponent;throw new Error("Root component not found")}}class zt{static create(t,e,n,s){const i=n.theme||"light",o=h.element("div",{class:`sqd-designer sqd-theme-${i}`});t.appendChild(o);const r=Bt.create(o,e,s),a=e.services.uiComponents.map((t=>t.create(o,s))),d=e.services.daemons.map((t=>t.create(s))),l=new zt(o,e.layoutController,r,a,d);return l.reloadLayout(),window.addEventListener("resize",l.onResizeHandler,!1),l}constructor(t,e,n,s,i){this.root=t,this.layoutController=e,this.workspace=n,this.uiComponents=s,this.daemons=i,this.onResizeHandler=()=>this.onResize()}destroy(){var t;window.removeEventListener("resize",this.onResizeHandler,!1),this.workspace.destroy(),this.uiComponents.forEach((t=>t.destroy())),this.daemons.forEach((t=>t.destroy())),null===(t=this.root.parentElement)||void 0===t||t.removeChild(this.root)}onResize(){this.reloadLayout()}reloadLayout(){const t=this.layoutController.isMobile();h.toggleClass(this.root,!t,"sqd-layout-desktop"),h.toggleClass(this.root,t,"sqd-layout-mobile")}}class Pt{static create(t,e,n){const s=h.svg("svg");s.style.marginLeft="-10px",s.style.marginTop="-10px",t.appendChild(s);const i={parentSequence:[],step:e,depth:0,position:0,isInputConnected:!0,isOutputConnected:!0},o=n.stepComponentFactory.create(s,i,n);return h.attrs(s,{width:o.view.width+20,height:o.view.height+20}),h.translate(o.view.g,10,10),new Pt(o.view.width,o.view.height)}constructor(t,e){this.width=t,this.height=e}destroy(){}}class Et{constructor(){this.create=Pt.create}}class Mt{static create(t,e){const n=h.element("div",{class:"sqd-control-bar"}),s=Rt(p.center,"Reset view");n.appendChild(s);const i=Rt(p.zoomIn,"Zoom in");n.appendChild(i);const o=Rt(p.zoomOut,"Zoom out");n.appendChild(o);let r=null,a=null;e&&(r=Rt(p.undo,"Undo"),n.appendChild(r),a=Rt(p.redo,"Redo"),n.appendChild(a));const d=Rt(p.move,"Turn on/off drag and drop");d.classList.add("sqd-disabled"),n.appendChild(d);const l=Rt(p.delete,"Delete selected step");return l.classList.add("sqd-delete"),l.classList.add("sqd-hidden"),n.appendChild(l),t.appendChild(n),new Mt(s,i,o,r,a,d,l)}constructor(t,e,n,s,i,o,r){this.resetButton=t,this.zoomInButton=e,this.zoomOutButton=n,this.undoButton=s,this.redoButton=i,this.disableDragButton=o,this.deleteButton=r}bindResetButtonClick(t){Tt(this.resetButton,t)}bindZoomInButtonClick(t){Tt(this.zoomInButton,t)}bindZoomOutButtonClick(t){Tt(this.zoomOutButton,t)}bindUndoButtonClick(t){if(!this.undoButton)throw new Error("Undo button is disabled");Tt(this.undoButton,t)}bindRedoButtonClick(t){if(!this.redoButton)throw new Error("Redo button is disabled");Tt(this.redoButton,t)}bindDisableDragButtonClick(t){Tt(this.disableDragButton,t)}bindDeleteButtonClick(t){Tt(this.deleteButton,t)}setIsDeleteButtonHidden(t){h.toggleClass(this.deleteButton,t,"sqd-hidden")}setDisableDragButtonDisabled(t){h.toggleClass(this.disableDragButton,t,"sqd-disabled")}setUndoButtonDisabled(t){if(!this.undoButton)throw new Error("Undo button is disabled");h.toggleClass(this.undoButton,t,"sqd-disabled")}setRedoButtonDisabled(t){if(!this.redoButton)throw new Error("Redo button is disabled");h.toggleClass(this.redoButton,t,"sqd-disabled")}}function Tt(t,e){t.addEventListener("click",(t=>{t.preventDefault(),e()}),!1)}function Rt(t,e){const n=h.element("div",{class:"sqd-control-bar-button",title:e}),s=p.createSvg("sqd-control-bar-button-icon",t);return n.appendChild(s),n}class Lt{static create(t,e){const n=e.controlBar.isUndoRedoSupported(),s=Mt.create(t,n),i=new Lt(s,e.controlBar,n);return s.bindResetButtonClick((()=>i.onResetButtonClicked())),s.bindZoomInButtonClick((()=>i.onZoomInButtonClicked())),s.bindZoomOutButtonClick((()=>i.onZoomOutButtonClicked())),s.bindDisableDragButtonClick((()=>i.onMoveButtonClicked())),s.bindDeleteButtonClick((()=>i.onDeleteButtonClicked())),e.controlBar.subscribe((()=>i.refreshButtons())),n&&(s.bindUndoButtonClick((()=>i.onUndoButtonClicked())),s.bindRedoButtonClick((()=>i.onRedoButtonClicked()))),i.refreshButtons(),i}constructor(t,e,n){this.view=t,this.controlBarApi=e,this.isUndoRedoSupported=n}destroy(){}onResetButtonClicked(){this.controlBarApi.resetViewport()}onZoomInButtonClicked(){this.controlBarApi.zoomIn()}onZoomOutButtonClicked(){this.controlBarApi.zoomOut()}onMoveButtonClicked(){this.controlBarApi.toggleIsDragDisabled()}onUndoButtonClicked(){this.controlBarApi.tryUndo()}onRedoButtonClicked(){this.controlBarApi.tryRedo()}onDeleteButtonClicked(){this.controlBarApi.tryDelete()}refreshButtons(){this.refreshDeleteButtonVisibility(),this.refreshIsDragDisabled(),this.isUndoRedoSupported&&this.refreshUndoRedoAvailability()}refreshIsDragDisabled(){const t=this.controlBarApi.isDragDisabled();this.view.setDisableDragButtonDisabled(!t)}refreshUndoRedoAvailability(){const t=this.controlBarApi.canUndo(),e=this.controlBarApi.canRedo();this.view.setUndoButtonDisabled(!t),this.view.setRedoButtonDisabled(!e)}refreshDeleteButtonVisibility(){const t=this.controlBarApi.canDelete();this.view.setIsDeleteButtonHidden(!t)}}class Ft{constructor(){this.create=Lt.create}}const Vt=["Backspace","Delete"],Ht=["INPUT","TEXTAREA"];class At{static create(t){const e=new At(t.controlBar);return document.addEventListener("keyup",e.onKeyUp,!1),e}constructor(t){this.controlBarApi=t,this.onKeyUp=t=>{Vt.includes(t.key)&&(document.activeElement&&Ht.includes(document.activeElement.tagName)||this.controlBarApi.canDelete()&&(t.preventDefault(),t.stopPropagation(),this.controlBarApi.tryDelete()))}}destroy(){document.removeEventListener("keyup",this.onKeyUp,!1)}}class Ot{constructor(){this.create=At.create}}class Zt{static create(t,e,n){const s=h.element("div",{class:"sqd-smart-editor"}),i=h.element("div",{class:"sqd-smart-editor-toggle",title:"Toggle editor"});t.appendChild(i),t.appendChild(s);const o=T.create(s,e,"sqd-editor sqd-step-editor",n.stepEditorProvider,"sqd-editor sqd-global-editor",n.globalEditorProvider);return new Zt(s,i,o)}constructor(t,e,n){this.root=t,this.toggle=e,this.editor=n}bindToggleIsCollapsedClick(t){this.toggle.addEventListener("click",(e=>{e.preventDefault(),t()}),!1)}setIsCollapsed(t){h.toggleClass(this.root,t,"sqd-hidden"),h.toggleClass(this.toggle,t,"sqd-collapsed"),this.toggleIcon&&this.toggle.removeChild(this.toggleIcon),this.toggleIcon=p.createSvg("sqd-smart-editor-toggle-icon",t?p.options:p.close),this.toggle.appendChild(this.toggleIcon)}destroy(){this.editor.destroy()}}class Xt{static create(t,e,n){const s=Zt.create(t,e,n),i=new Xt(s,e.workspace);return s.bindToggleIsCollapsedClick((()=>i.toggleIsCollapsedClick())),i.setIsCollapsed(e.editor.isVisibleAtStart()),i}constructor(t,e){this.view=t,this.workspaceApi=e}setIsCollapsed(t){this.isCollapsed=t,this.view.setIsCollapsed(t)}toggleIsCollapsedClick(){this.setIsCollapsed(!this.isCollapsed),this.workspaceApi.updateCanvasSize()}destroy(){this.view.destroy()}}class Ut{constructor(t){this.configuration=t}create(t,e){return Xt.create(t,e,this.configuration)}}const $t={passive:!1};class Wt{static create(t,e){const n=h.element("div",{class:"sqd-scrollbox"});t.appendChild(n);const s=new Wt(n,e);return window.addEventListener("resize",s.onResize,!1),n.addEventListener("wheel",(t=>s.onWheel(t)),!1),n.addEventListener("touchstart",(t=>s.onTouchStart(t)),$t),n.addEventListener("mousedown",(t=>s.onMouseDown(t)),!1),s}constructor(t,e){this.root=t,this.viewport=e,this.onResize=()=>{this.refresh()},this.onTouchStart=t=>{t.preventDefault(),this.startScroll(at(t))},this.onMouseDown=t=>{this.startScroll(rt(t))},this.onTouchMove=t=>{t.preventDefault(),this.moveScroll(at(t))},this.onMouseMove=t=>{t.preventDefault(),this.moveScroll(rt(t))},this.onTouchEnd=t=>{t.preventDefault(),this.stopScroll()},this.onMouseUp=t=>{t.preventDefault(),this.stopScroll()}}setContent(t){this.content&&this.root.removeChild(this.content.element),t.classList.add("sqd-scrollbox-body"),this.root.appendChild(t),this.reload(t)}refresh(){this.content&&this.reload(this.content.element)}destroy(){window.removeEventListener("resize",this.onResize,!1)}reload(t){let e=Math.min(.7*this.viewport.clientHeight,t.clientHeight);e=Math.min(e,this.viewport.clientHeight-206),this.root.style.height=e+"px",t.style.top="0px",this.content={element:t,height:e}}onWheel(t){if(t.stopPropagation(),this.content){const e=t.deltaY>0?-25:25,n=this.getScrollTop();this.setScrollTop(n+e)}}startScroll(t){this.scroll||(window.addEventListener("touchmove",this.onTouchMove,$t),window.addEventListener("mousemove",this.onMouseMove,!1),window.addEventListener("touchend",this.onTouchEnd,$t),window.addEventListener("mouseup",this.onMouseUp,!1)),this.scroll={startPositionY:t.y,startScrollTop:this.getScrollTop()}}moveScroll(t){if(this.scroll){const e=t.y-this.scroll.startPositionY;this.setScrollTop(this.scroll.startScrollTop+e)}}stopScroll(){this.scroll&&(window.removeEventListener("touchmove",this.onTouchMove,$t),window.removeEventListener("mousemove",this.onMouseMove,!1),window.removeEventListener("touchend",this.onTouchEnd,$t),window.removeEventListener("mouseup",this.onMouseUp,!1),this.scroll=void 0)}getScrollTop(){return this.content&&this.content.element.style.top?parseInt(this.content.element.style.top):0}setScrollTop(t){if(this.content){const e=this.content.element.clientHeight-this.content.height,n=Math.max(Math.min(t,0),-e);this.content.element.style.top=n+"px"}}}const jt=/^[a-zA-Z][a-zA-Z0-9_-]+$/;class Nt{static validate(t){if(!jt.test(t))throw new Error(`Step type "${t}" contains not allowed characters`)}}class Qt{static create(t,e,n){const s=h.element("div",{class:`sqd-toolbox-item sqd-type-${e.type}`,title:e.name}),i=n.tryGetIconUrl(e),o=h.element("div",{class:"sqd-toolbox-item-icon"});if(i){const t=h.element("img",{class:"sqd-toolbox-item-icon-image",src:i});o.appendChild(t)}else o.classList.add("sqd-no-icon");const r=h.element("div",{class:"sqd-toolbox-item-text"});return r.textContent=e.name,s.appendChild(o),s.appendChild(r),t.appendChild(s),new Qt(s)}constructor(t){this.root=t}bindMousedown(t){this.root.addEventListener("mousedown",t,!1)}bindTouchstart(t){this.root.addEventListener("touchstart",t,!1)}bindContextMenu(t){this.root.addEventListener("contextmenu",t,!1)}}class Yt{static create(t,e,n){Nt.validate(e.type);const s=Qt.create(t,e,n),i=new Yt(e,n);return s.bindMousedown((t=>i.onMousedown(t))),s.bindTouchstart((t=>i.onTouchstart(t))),s.bindContextMenu((t=>i.onContextMenu(t))),i}constructor(t,e){this.step=t,this.api=e}onTouchstart(t){t.preventDefault(),1===t.touches.length&&(t.stopPropagation(),this.tryDrag(at(t)))}onMousedown(t){t.stopPropagation(),0===t.button&&this.tryDrag(rt(t))}onContextMenu(t){t.preventDefault()}tryDrag(t){this.api.tryDrag(t,this.step)}}class Gt{static create(t,e){const n=h.element("div",{class:"sqd-toolbox"}),s=h.element("div",{class:"sqd-toolbox-header"}),i=h.element("div",{class:"sqd-toolbox-header-title"});i.innerText="Toolbox";const o=h.element("div",{class:"sqd-toolbox-body"}),r=h.element("input",{class:"sqd-toolbox-filter",type:"text",placeholder:"Search..."});n.appendChild(s),n.appendChild(o),s.appendChild(i),o.appendChild(r),t.appendChild(n);const a=Wt.create(o,t);return new Gt(s,o,r,a,e)}constructor(t,e,n,s,i){this.header=t,this.body=e,this.filterInput=n,this.scrollBoxView=s,this.api=i}bindToggleIsCollapsedClick(t){this.header.addEventListener("click",(function(e){e.preventDefault(),t()}),!1)}bindFilterInputChange(t){function e(e){t(e.target.value)}this.filterInput.addEventListener("keyup",e,!1),this.filterInput.addEventListener("blur",e,!1)}setIsCollapsed(t){h.toggleClass(this.body,t,"sqd-hidden"),this.headerToggleIcon&&this.header.removeChild(this.headerToggleIcon),this.headerToggleIcon=p.createSvg("sqd-toolbox-toggle-icon",t?p.expand:p.close),this.header.appendChild(this.headerToggleIcon),t||this.scrollBoxView.refresh()}setGroups(t){const e=h.element("div");t.forEach((t=>{const n=h.element("div",{class:"sqd-toolbox-group-title"});n.innerText=t.name,e.appendChild(n),t.steps.forEach((t=>Yt.create(e,t,this.api)))})),this.scrollBoxView.setContent(e)}destroy(){this.scrollBoxView.destroy()}}class Jt{static create(t,e,n){const s=Gt.create(t,e.toolbox),i=new Jt(s,n);return i.render(),i.setIsCollapsed(e.toolbox.isVisibleAtStart()),s.bindToggleIsCollapsedClick((()=>i.toggleIsCollapsedClick())),s.bindFilterInputChange((t=>i.onFilterInputChanged(t))),i}constructor(t,e){this.view=t,this.configuration=e}destroy(){this.view.destroy()}render(){const t=this.configuration.groups.map((t=>({name:t.name,steps:t.steps.filter((t=>!this.filter||t.name.toLowerCase().includes(this.filter)))}))).filter((t=>t.steps.length>0));this.view.setGroups(t)}setIsCollapsed(t){this.isCollapsed=t,this.view.setIsCollapsed(t)}toggleIsCollapsedClick(){this.setIsCollapsed(!this.isCollapsed)}onFilterInputChanged(t){this.filter=t.toLowerCase(),this.render()}}class _t{constructor(t){this.configuration=t}create(t,e){return Jt.create(t,e,this.configuration)}}const Kt={view:{paddingTop:20,paddingX:20,inputSize:18,inputIconSize:14,label:{height:22,paddingX:10,minWidth:50,radius:10}}};class te{static create(t){return new te(null!=t?t:Kt)}constructor(t){var e;this.configuration=t,this.componentType="container",this.createComponentView=(e=this.configuration.view,(t,n,i)=>{const{step:o}=n,r=h.svg("g",{class:`sqd-step-container sqd-type-${o.type}`});t.appendChild(r);const a=X.create(r,e.paddingTop,e.label,o.name,"primary"),d=i.createSequenceComponent(r,o.sequence),l=a.width/2,c=Math.max(l-d.view.joinX,0)+e.paddingX,p=Math.max(l-(d.view.width-d.view.joinX),0)+e.paddingX,u=c+d.view.width+p,g=e.paddingTop+e.label.height+d.view.height,v=d.view.joinX+c;h.translate(a.g,v,0),h.translate(d.view.g,c,e.paddingTop+e.label.height);const m=i.getStepIconUrl(),w=H.createRectInput(r,v,0,e.inputSize,e.inputIconSize,m);A.createStraightJoin(r,new s(v,0),e.paddingTop);const C=$.create(r,[u],g);return{g:r,width:u,height:g,joinX:v,placeholders:null,sequenceComponents:[d],getClientPosition:()=>C.getClientPosition(),resolveClick:t=>!(!C.resolveClick(t)&&!r.contains(t.element))||null,setIsDragging(t){w.setIsHidden(t)},setIsSelected(t){C.setIsSelected(t)},setIsDisabled(t){h.toggleClass(r,t,"sqd-disabled")},hasOutput:()=>d.hasOutput}})}getChildren(t){return{type:o.singleSequence,sequences:t.sequence}}}class ee{create(){return{canCreate:()=>!0}}}const ne={gapWidth:100,gapHeight:24,radius:6,iconSize:16};class se{static create(t){return new se(null!=t?t:ne)}constructor(t){this.configuration=t,this.gapSize=new s(this.configuration.gapWidth,this.configuration.gapHeight)}createForGap(t,e,n){return ot.create(t,this.gapSize,a.none,e,n,this.configuration)}createForArea(t,e,n,s,i){return ot.create(t,e,n,s,i,this.configuration)}}const ie=30;class oe{static create(t,e,n,i){const o=h.svg("g",{class:"sqd-root-start-stop"});t.appendChild(o);const r=Q.create(o,{sequence:e,depth:0,isInputConnected:!0,isOutputConnected:!0},i),d=r.view,l=d.joinX-ie/2,c=ie+d.height,u=n?18:22,g=re(n?p.folder:p.play,u);h.translate(g,l,0),o.appendChild(g),h.translate(d.g,0,ie);const v=re(n?p.folder:p.stop,u);h.translate(v,l,c),o.appendChild(v);let m=null,w=null;if(n){const t=new s(ie,ie);m=i.services.placeholder.createForArea(o,t,a.out,n.sequence,n.index),w=i.services.placeholder.createForArea(o,t,a.out,n.sequence,n.index),h.translate(m.view.g,l,0),h.translate(w.view.g,l,c)}return new oe(o,d.width,d.height+2*ie,d.joinX,r,m,w)}constructor(t,e,n,s,i,o,r){this.g=t,this.width=e,this.height=n,this.joinX=s,this.component=i,this.startPlaceholder=o,this.endPlaceholder=r}destroy(){var t;null===(t=this.g.parentNode)||void 0===t||t.removeChild(this.g)}}function re(t,e){const n=ie/2,s=h.svg("circle",{class:"sqd-root-start-stop-circle",cx:n,cy:n,r:n}),i=h.svg("g");i.appendChild(s);const o=(ie-e)/2,r=p.appendPath(i,"sqd-root-start-stop-icon",t,e);return h.translate(r,o,o),i}class ae{static create(t,e,n,s){const i=oe.create(t,e,n,s);return new ae(i)}constructor(t){this.view=t}resolveClick(t){return this.view.component.resolveClick(t)}findById(t){return this.view.component.findById(t)}getPlaceholders(t){this.view.component.getPlaceholders(t),this.view.startPlaceholder&&this.view.endPlaceholder&&(t.push(this.view.startPlaceholder),t.push(this.view.endPlaceholder))}setIsDragging(t){this.view.component.setIsDragging(t),this.view.startPlaceholder&&this.view.endPlaceholder&&(this.view.startPlaceholder.setIsVisible(t),this.view.endPlaceholder.setIsVisible(t))}updateBadges(t){this.view.component.updateBadges(t)}}class de{constructor(){this.create=ae.create}}const le={view:{minContainerWidth:40,paddingX:20,paddingTop:20,connectionHeight:16,inputSize:18,inputIconSize:14,branchNameLabel:{height:22,paddingX:10,minWidth:50,radius:10},nameLabel:{height:22,paddingX:10,minWidth:50,radius:10}}};class ce{static create(t){return new ce(null!=t?t:le)}constructor(t){var e;this.configuration=t,this.componentType="switch",this.createComponentView=(e=this.configuration.view,(t,n,i)=>{const{step:o}=n,r=h.svg("g",{class:`sqd-step-switch sqd-type-${o.type}`});t.appendChild(r);const a=Object.keys(o.branches),d=a.map((t=>i.createSequenceComponent(r,o.branches[t]))),l=a.map((t=>{const n=e.paddingTop+e.nameLabel.height+e.connectionHeight;return X.create(r,n,e.branchNameLabel,t,"secondary")})),c=X.create(r,e.paddingTop,e.nameLabel,o.name,"primary");let p=0;const u=d.map(((t,n)=>{const s=Math.max(l[n].width,e.minContainerWidth)/2,i=Math.max(s-t.view.joinX,0)+e.paddingX,o=Math.max(s-(t.view.width-t.view.joinX),0)+e.paddingX,r=t.view.width+i+o,a=t.view.joinX+i,d=p;return p+=r,{width:r,branchOffsetLeft:i,offsetX:d,joinX:a}})),g=Math.floor(a.length/2),v=u[g];let m=v.offsetX;a.length%2!=0&&(m+=v.joinX);const w=u.reduce(((t,e)=>t+e.width),0),C=Math.max(...d.map((t=>t.view.height))),f=c.width/2+e.paddingX,b=Math.max(f-m,0),q=Math.max(f-(w-m),0),x=b+w+q,y=C+e.paddingTop+e.nameLabel.height+e.branchNameLabel.height+2*e.connectionHeight,S=b+m;h.translate(c.g,S,0);const I=e.paddingTop+e.nameLabel.height+e.branchNameLabel.height+e.connectionHeight;d.forEach(((t,i)=>{const o=u[i],a=b+o.offsetX+o.branchOffsetLeft;if(h.translate(l[i].g,b+o.offsetX+o.joinX,0),h.translate(t.view.g,a,I),t.hasOutput&&n.isOutputConnected){const n=e.paddingTop+e.nameLabel.height+e.branchNameLabel.height+e.connectionHeight+t.view.height,i=y-n-e.connectionHeight;i>0&&A.createStraightJoin(r,new s(b+o.offsetX+o.joinX,n),i)}}));let k=null;if(e.inputSize>0){const t=i.getStepIconUrl();k=H.createRectInput(r,S,0,e.inputSize,e.inputIconSize,t)}if(A.createStraightJoin(r,new s(S,0),e.paddingTop),A.createJoins(r,new s(S,e.paddingTop+e.nameLabel.height),u.map((t=>new s(b+t.offsetX+t.joinX,e.paddingTop+e.nameLabel.height+e.connectionHeight)))),n.isOutputConnected){const t=d.map(((t,e)=>t.hasOutput?e:null)).filter((t=>null!==t)).map((t=>new s(b+u[t].offsetX+u[t].joinX,e.paddingTop+e.connectionHeight+e.nameLabel.height+e.branchNameLabel.height+C)));t.length>0&&A.createJoins(r,new s(S,y),t)}const D=u.map((t=>t.width));D[0]+=b,D[D.length-1]+=q;const B=$.create(r,D,y);return{g:r,width:x,height:y,joinX:S,placeholders:null,sequenceComponents:d,getClientPosition:()=>B.getClientPosition(),resolveClick:t=>!(!B.resolveClick(t)&&!r.contains(t.element))||null,setIsDragging(t){null==k||k.setIsHidden(t)},setIsSelected(t){B.setIsSelected(t)},setIsDisabled(t){h.toggleClass(r,t,"sqd-disabled")},hasOutput:()=>d.some((t=>t.hasOutput))}})}getChildren(t){return{type:o.branches,sequences:t.branches}}}const he={view:{paddingLeft:12,paddingRight:12,paddingY:10,textMarginLeft:12,minTextWidth:70,iconSize:22,radius:5,inputSize:14,outputSize:10}};class pe{static create(t){return new pe(null!=t?t:he)}constructor(t){this.configuration=t,this.componentType="task",this.createComponentView=Y(!1,this.configuration.view)}getChildren(){return null}}class ue{constructor(){this.create=Q.create}}class ge{constructor(){this.wrap=t=>t}}class ve{static resolve(t,e){const n={};return function(t,e){for(const n of e)n.steps&&(t.steps=(t.steps||[]).concat(n.steps)),n.stepComponentViewWrapper&&(t.stepComponentViewWrapper=n.stepComponentViewWrapper),n.badges&&(t.badges=(t.badges||[]).concat(n.badges)),n.uiComponents&&(t.uiComponents=(t.uiComponents||[]).concat(n.uiComponents)),n.draggedComponent&&(t.draggedComponent=n.draggedComponent),n.wheelController&&(t.wheelController=n.wheelController),n.placeholderController&&(t.placeholderController=n.placeholderController),n.placeholder&&(t.placeholder=n.placeholder),n.viewportController&&(t.viewportController=n.viewportController),n.rootComponent&&(t.rootComponent=n.rootComponent),n.sequenceComponent&&(t.sequenceComponent=n.sequenceComponent),n.daemons&&(t.daemons=(t.daemons||[]).concat(n.daemons))}(n,t||[]),function(t,e){t.steps||(t.steps=[]),t.steps.push(te.create()),t.steps.push(ce.create()),t.steps.push(pe.create()),t.stepComponentViewWrapper||(t.stepComponentViewWrapper=new ge),t.badges||(t.badges=[]),Dt(t.badges)<0&&t.badges.push(V.create()),t.draggedComponent||(t.draggedComponent=new Et),t.uiComponents||(t.uiComponents=[]),e.controlBar&&t.uiComponents.push(new Ft),e.editors&&t.uiComponents.push(new Ut(e.editors)),e.toolbox&&t.uiComponents.push(new _t(e.toolbox)),t.wheelController||(t.wheelController=new tt),t.placeholderController||(t.placeholderController=new ee),t.placeholder||(t.placeholder=se.create()),t.viewportController||(t.viewportController=new st),t.rootComponent||(t.rootComponent=new de),t.sequenceComponent||(t.sequenceComponent=new ue),t.daemons||(t.daemons=[]),t.daemons.push(new Ot)}(n,e),n}}class me{static create(t,e,n){if(!t)throw new Error("Placeholder is not set");if(s=t,document.compareDocumentPosition(s)&Node.DOCUMENT_POSITION_DISCONNECTED)throw new Error("Placeholder is not attached to the DOM");var s;if(!e)throw new Error("Start definition is not set");if(!n)throw new Error("Configuration is not set");const i=n;!function(t){if(void 0===t.controlBar)throw new Error('The "controlBar" property is not defined in the configuration');if(t.toolbox&&void 0!==t.toolbox.isHidden)throw new Error('The "isHidden" property in the toolbox configuration is depreciated');if(t.editors&&void 0!==t.editors.isHidden)throw new Error('The "isHidden" property in the editors configuration is depreciated')}(i);const o=ve.resolve(n.extensions,i),r=mt.create(t,e,i,o),a=k.create(r),d=zt.create(t,r,i,a),l=new me(d,r.state,r.stepsTraverser,a);return d.workspace.onReady.subscribe((()=>l.onReady.forward())),r.state.onDefinitionChanged.subscribe((()=>{setTimeout((()=>l.onDefinitionChanged.forward(r.state.definition)))})),r.state.onSelectedStepIdChanged.subscribe((()=>l.onSelectedStepIdChanged.forward(r.state.selectedStepId))),l}constructor(t,n,s,i){this.view=t,this.state=n,this.stepsTraverser=s,this.api=i,this.onReady=new e,this.onDefinitionChanged=new e,this.onSelectedStepIdChanged=new e}getDefinition(){return this.state.definition}isValid(){return this.view.workspace.isValid}isReadonly(){return this.state.isReadonly}setIsReadonly(t){this.state.setIsReadonly(t)}getSelectedStepId(){return this.state.selectedStepId}selectStepById(t){this.state.setSelectedStepId(t)}clearSelectedStep(){this.state.setSelectedStepId(null)}moveViewportToStep(t){this.api.viewport.moveViewportToStep(t)}moveViewPortToStep(t){this.moveViewportToStep(t)}updateRootComponent(){this.api.workspace.updateRootComponent()}updateBadges(){this.api.workspace.updateBadges()}getStepParents(t){return this.stepsTraverser.getParents(this.state.definition,t)}destroy(){this.view.destroy()}}const we=t=>(e,n,i)=>{const{step:o}=n,d=h.svg("g",{class:`sqd-step-folder sqd-type-${o.type}`});e.appendChild(d);const l=2*t.paddingX+t.iconSize,c=h.svg("text",{x:l,y:t.nameHeight1,class:"sqd-step-folder-name"});c.textContent=o.name,d.appendChild(c);const u=c.getBBox(),g=Math.max(u.width,t.minNameWidth),v=t.nameHeight1+t.nameHeight2,m=function(t){switch(t){case 0:return"no steps";case 1:return"1 step";default:return`${t} steps`}}(o.sequence.length),w=h.svg("text",{class:"sqd-step-folder-button-text",x:l+t.buttonPaddingX,y:v+t.buttonHeight/2});w.textContent=m,d.appendChild(w);const C=w.getBBox(),f=p.appendPath(d,"sqd-step-folder-button-icon-path",p.folderIn,t.buttonIconSize);h.translate(f,l+2*t.buttonPaddingX+C.width,v+(t.buttonHeight-t.buttonIconSize)/2);const b=3*t.buttonPaddingX+C.width+t.buttonIconSize,q=h.svg("rect",{class:"sqd-step-folder-button-rect",width:b,height:t.buttonHeight,rx:4,ry:4,x:l+.5,y:v+.5});d.appendChild(q);const x=v+t.buttonHeight+t.paddingBottom,y=l+Math.max(g,b)+t.paddingX,S=y/2,I=h.svg("rect",{x:.5,y:.5,class:"sqd-step-folder-rect",width:y,height:x,rx:t.rectRadius,ry:t.rectRadius});d.insertBefore(I,c);const k=y/4,D=h.svg("rect",{class:"sqd-step-folder-tab-rect",x:t.paddingX,y:-6,width:k,height:12,rx:t.rectRadius,ry:t.rectRadius});d.insertBefore(D,I);const B=i.getStepIconUrl(),z=B?h.svg("image",{href:B}):h.svg("rect",{class:"sqd-step-folder-empty-icon",rx:4,ry:4});h.attrs(z,{x:t.paddingX,y:(x-t.iconSize)/2,width:t.iconSize,height:t.iconSize}),d.appendChild(z);const P=H.createRoundInput(d,S,0,t.inputSize),E=U.create(d,S,x,t.outputSize),M=new s(y-2*t.placeholderMargin,x-2*t.placeholderMargin),T=i.createPlaceholderForArea(d,M,a.in,n.step.sequence,n.step.sequence.length);return h.translate(T.view.g,t.placeholderMargin,t.placeholderMargin),{g:d,width:y,height:x,joinX:S,placeholders:[T],sequenceComponents:null,getClientPosition(){const t=I.getBoundingClientRect();return new s(t.x,t.y)},resolveClick(t){return t.element===q?{type:r.openFolder,step:n.step}:!!this.g.contains(t.element)||null},setIsDragging(t){h.toggleClass(D,t,"sqd-hidden"),P.setIsHidden(t),E.setIsHidden(t)},setIsDisabled(t){h.toggleClass(d,t,"sqd-disabled")},setIsSelected(t){h.toggleClass(I,t,"sqd-selected")},hasOutput:()=>!0}},Ce=(t,e)=>(n,i,o)=>{const{step:r}=i,a=h.svg("g",{class:`sqd-step-icon sqd-type-${r.type}`});n.appendChild(a);const d=e.size/2,l=h.svg("circle",{cx:d,cy:d,r:d,class:"sqd-step-icon-circle"});a.appendChild(l);const c=o.getStepIconUrl();if(c){const t=h.svg("image",{class:"sqd-step-icon-image",href:c,x:(e.size-e.iconSize)/2,y:(e.size-e.iconSize)/2,width:e.iconSize,height:e.iconSize});a.appendChild(t)}const p=0===i.depth&&0===i.position&&!i.isInputConnected,u=t,g=p?null:H.createRoundInput(a,d,0,e.inputSize),v=u?null:U.create(a,d,e.size,e.outputSize);return{g:a,width:e.size,height:e.size,joinX:d,placeholders:null,sequenceComponents:null,resolveClick(t){return!!this.g.contains(t.element)||null},setIsSelected(t){h.toggleClass(l,t,"sqd-selected")},setIsDisabled(t){h.toggleClass(this.g,t,"sqd-disabled")},getClientPosition(){const t=this.g.getBoundingClientRect();return new s(t.x,t.y)},setIsDragging(t){null==g||g.setIsHidden(t),null==v||v.setIsHidden(t)},hasOutput:()=>!!v}},fe=(t,e)=>(n,i,o)=>{const r=h.svg("g");n.appendChild(r);const a=t.paddingLeft+t.circleSize+t.textMarginLeft,d=h.svg("text",{class:"sqd-large-task-name-text",x:a,y:t.nameY});d.textContent=i.step.name,r.appendChild(d);const l=d.getBBox(),c=h.svg("text",{class:"sqd-large-task-description-text",x:a,y:t.descriptionY});c.textContent=e(i.step),r.appendChild(c);const p=c.getBBox(),u=h.svg("circle",{class:"sqd-large-task-circle",cx:t.paddingLeft+t.circleSize/2,cy:t.paddingY+t.circleSize/2,r:t.circleSize/2});r.appendChild(u);const g=Math.max(l.width,p.width,t.minTextWidth),v=t.circleSize+g+t.paddingLeft+t.paddingRight+t.textMarginLeft,m=t.circleSize+2*t.paddingY,w=o.getStepIconUrl();if(w){const e=h.svg("image",{href:w,width:t.iconSize,height:t.iconSize,x:t.paddingLeft+t.circleSize/2-t.iconSize/2,y:t.paddingY+t.circleSize/2-t.iconSize/2});r.appendChild(e)}const C=H.createRoundInput(r,v/2,0,t.inputSize),f=U.create(r,v/2,m,t.outputSize),b=h.svg("rect",{class:"sqd-large-task-rect",x:.5,y:.5,width:v,height:m,rx:4,ry:4});return r.insertBefore(b,d),{g:r,width:v,height:m,joinX:v/2,placeholders:null,sequenceComponents:null,resolveClick(t){return!!this.g.contains(t.element)||null},setIsSelected(t){h.toggleClass(b,t,"sqd-selected")},setIsDisabled(t){h.toggleClass(r,t,"sqd-disabled")},getClientPosition(){const t=r.getBoundingClientRect();return new s(t.x,t.y)},setIsDragging(t){C.setIsHidden(t),f.setIsHidden(t)},hasOutput:()=>!0}};class be{static create(t){const e=h.element("div",{class:"sqd-path-bar"}),n=h.element("div",{class:"sqd-path-bar-reset-button",title:"Go to top"}),s=p.createSvg("sqd-path-bar-reset-button-icon",p.folderUp),i=h.element("div",{class:"sqd-path-bar-items"});return e.appendChild(n),e.appendChild(i),n.appendChild(s),t.appendChild(e),new be(e,i,n)}constructor(t,e,n){this.root=t,this.items=e,this.resetButton=n}bindOnItemClick(t){this.onClickHandler=t}bindOnResetClick(t){this.resetButton.addEventListener("click",(e=>{e.preventDefault(),t()}))}reload(t){const e=null===t;if(h.toggleClass(this.root,e,"sqd-hidden"),e)return;this.items.innerHTML="";const n=Math.max(0,t.length-3);for(let e=n;e<t.length;e++){const s=t[e];if(e>0){const t=h.element("span",{class:"sqd-path-bar-separator"});t.innerText=e===n?"...":"/",this.items.appendChild(t)}const i=h.element("span",{class:"sqd-path-bar-item"});i.innerText=s,i.addEventListener("click",(t=>{t.preventDefault(),this.onClickHandler&&this.onClickHandler(e)})),this.items.appendChild(i)}}}class qe{static create(t,e){const n=be.create(t),s=new qe(n,e.pathBar);return e.pathBar.subscribe((()=>s.reloadPath())),n.bindOnItemClick((t=>s.onItemClicked(t))),n.bindOnResetClick((()=>s.onResetClicked())),s.reloadPath(),s}constructor(t,e){this.view=t,this.api=e}destroy(){}onItemClicked(t){const e=this.api.getFolderPath().splice(0,t+1);this.api.setFolderPath(e)}onResetClicked(){this.api.setFolderPath([])}reloadPath(){const t=this.api.getFolderPathStepNames();this.view.reload(0===t.length?null:t)}}class xe{constructor(){this.create=qe.create}}const ye={view:{rectRadius:5,nameHeight1:20,nameHeight2:16,paddingX:12,paddingBottom:12,iconSize:22,buttonHeight:24,buttonPaddingX:6,buttonIconSize:14,minNameWidth:40,placeholderMargin:10,inputSize:14,outputSize:10}};class Se{static create(t){return new Se(null!=t?t:ye)}constructor(t){this.configuration=t,this.componentType="folder",this.createComponentView=we(this.configuration.view)}getChildren(t){return{type:o.singleSequence,sequences:t.sequence}}}const Ie={view:{size:52,iconSize:28,inputSize:14,outputSize:10}};class ke{static create(t){return new ke(null!=t?t:Ie)}constructor(t){this.configuration=t,this.componentType="icon",this.createComponentView=Ce(!1,this.configuration.view)}getChildren(){return null}}const De={view:{size:52,iconSize:28,inputSize:14,outputSize:10}};class Be{static create(t){return new Be(null!=t?t:De)}constructor(t){this.configuration=t,this.componentType="interruptingIcon",this.createComponentView=Ce(!0,this.configuration.view)}getChildren(){return null}}const ze={view:{paddingLeft:12,paddingRight:12,paddingY:10,textMarginLeft:12,minTextWidth:70,iconSize:22,radius:5,inputSize:14,outputSize:10}};class Pe{static create(t){return new Pe(null!=t?t:ze)}constructor(t){this.configuration=t,this.componentType="interruptingTask",this.createComponentView=Y(!0,this.configuration.view)}getChildren(){return null}}const Ee=t=>`Task type: ${t.type}`,Me={textMarginLeft:12,minTextWidth:140,nameY:22,descriptionY:44,paddingLeft:12,paddingRight:12,paddingY:12,circleSize:40,iconSize:22,inputSize:14,outputSize:10},Te={view:Me,descriptionProvider:Ee};class Re{static create(t){return new Re(null!=t?t:Te)}constructor(t){var e,n;this.configuration=t,this.componentType="largeTask",this.createComponentView=fe(null!==(e=this.configuration.view)&&void 0!==e?e:Me,null!==(n=this.configuration.descriptionProvider)&&void 0!==n?n:Ee)}getChildren(){return null}}class Le{static create(t){return new Le([ke.create(null==t?void 0:t.icon),Be.create(null==t?void 0:t.interruptingIcon),Pe.create(null==t?void 0:t.interruptingTask),Se.create(null==t?void 0:t.folder),Re.create(null==t?void 0:t.largeTask)])}constructor(t){this.steps=t,this.uiComponents=[new xe]}}var Fe=n(62),Ve=n.n(Fe),He=n(36),Ae=n.n(He),Oe=n(793),Ze=n.n(Oe),Xe=n(892),Ue=n.n(Xe),$e=n(173),We=n.n($e),je=n(464),Ne=n.n(je),Qe=n(446),Ye={};Ye.styleTagTransform=Ne(),Ye.setAttributes=Ue(),Ye.insert=Ze().bind(null,"head"),Ye.domAPI=Ae(),Ye.insertStyleElement=We(),Ve()(Qe.Z,Ye),Qe.Z&&Qe.Z.locals&&Qe.Z.locals;var Ge=n(929),Je={};Je.styleTagTransform=Ne(),Je.setAttributes=Ue(),Je.insert=Ze().bind(null,"head"),Je.domAPI=Ae(),Je.insertStyleElement=We(),Ve()(Ge.Z,Je),Ge.Z&&Ge.Z.locals&&Ge.Z.locals;var _e=n(279),Ke={};Ke.styleTagTransform=Ne(),Ke.setAttributes=Ue(),Ke.insert=Ze().bind(null,"head"),Ke.domAPI=Ae(),Ke.insertStyleElement=We(),Ve()(_e.Z,Ke),_e.Z&&_e.Z.locals&&_e.Z.locals;var tn=n(769),en={};function nn(t,e,n){return{id:g.next(),componentType:"switch",type:"switch",name:t,branches:{true:e,false:n},properties:{}}}function sn(t){return{id:g.next(),componentType:"task",name:t,properties:{},type:"task"}}function on(t){return{id:g.next(),componentType:"interruptingTask",name:t,properties:{},type:"goto"}}en.styleTagTransform=Ne(),en.setAttributes=Ue(),en.insert=Ze().bind(null,"head"),en.domAPI=Ae(),en.insertStyleElement=We(),Ve()(tn.Z,en),tn.Z&&tn.Z.locals&&tn.Z.locals,document.addEventListener("DOMContentLoaded",(function(){const t=document.getElementById("designer"),e={properties:{},sequence:[sn("Validate"),nn("Is Valid",[sn("Write file"),sn("Send email")],[sn("Run trigger"),on('Goto "Validate"')]),sn("Send email")]},n={editors:{stepEditorProvider:t=>{const e=document.createElement("div");return e.innerText=`Step Editor, type=${t.type}, componentType=${t.componentType}`,e},globalEditorProvider:()=>{const t=document.createElement("div");return t.innerText="Global Editor",t}},steps:{iconUrlProvider:(t,e)=>`./assets/icon-${e}.svg`},toolbox:{groups:[("Steps",s=[nn("Is Valid",[],[]),sn("Validate"),sn("Write file"),sn("Send email"),sn("Run trigger"),on("Goto")],{name:"Steps",steps:s})]},controlBar:!0,extensions:[Le.create()]};var s;me.create(t,e,n)}))})()})();